## 总体流程
![](https://mc.qcloudimg.com/static/img/da229877b12d736b8b3415fdab20a64d/image.png)

## 注册服务商和子商户
- 在[微信支付服务商注册页面](https://pay.weixin.qq.com)上操作。
## 注册腾讯云
- 登入[腾讯云](https://www.qcloud.com)，注册腾讯云的账户，请使用QQ注册。 
- 注册成功后，进入腾讯云的页面，点击”云产品”，选择金融云下的微信云支付。
## 添加微信支付服务商
- 服务商须先通过[微信支付服务商申请](https://pay.weixin.qq.com)，然后登录腾讯云，在[云支付](https://console.qcloud.com/cpay)服务里的添加服务商页面，点击添加服务商，按要求填入相关信息，具体如下：

![](https://mc.qcloudimg.com/static/img/a3983f69fde2b8bbbe776f187f3452db/image.png)

参数说明：

- 微信支付商户号：微信支付服务商平台上的微信支付商户号，服务商在申请微信支付后，由微信支付分配的商户收款账号。 [查看](https://pay.weixin.qq.com/index.php/core/account/info)
- 商户名称：微信支付服务商平台上的商户名称。 [查看](https://pay.weixin.qq.com/index.php/core/account/info)
- AppID：服务商微信公众号AppID（应用ID），appid是微信公众账号或开放平台APP的唯一标识，在公众平台申请公众账号申请APP账号后，微信会自动分配对应的appid，用于标识该应用。可在微信公众平台-->开发者中心查看，商户的微信支付审核通过邮件中也会包含该字段值。 [查看](https://mp.weixin.qq.com)
- AppSecret: 服务商微信公众号AppSecret（应用密钥），AppSecret是APPID对应的接口密码，用于获取接口调用凭证时使用。可登录公众平台-->微信支付，获取AppSecret（需成为开发者且帐号没有异常状态），非必填项。[查看](https://mp.weixin.qq.com)
- 公司备注：企业相关备注。
- API密钥：微信支付服务商平台上的API密钥，交易过程生成签名的密钥。商户可根据邮件提示登录微信商户平台进行设置。也可按一下路径设置：微信商户平台(pay.weixin.qq.com)-->账户中心-->账户设置-->API安全-->密钥设置。 [查看](https://pay.weixin.qq.com/index.php/core/cert/api_cert)
- API证书：微信支付服务商平台上的API证书（pkcs12格式），开发所需的接口API证书，包含了私钥信息的证书文件，为p12（pfx）格式，由微信支付签发用来标识和界定身份。请登录微信支付商户平台，点击【账户中心】->【账户设置】->【API安全】->【下载证书】中，下载及设置。 [查看](https://pay.weixin.qq.com/index.php/core/cert/api_cert)
- 返佣比例：返佣数据仅用于统计参考，对应微信支付商户费率，以微信支付服务商平台结算数据为准，非必填。
- 返回结果：是否成功，成功则提示成功，失败则提示失败原因

参数来源如图所示：

 ![](https://mc.qcloudimg.com/static/img/80b38d6ff3cf403ac3e401fa9a93d507/image.png)


## 添加子服务商并配置权限
- 在子服务商管理页面，点击添加子服务商，配置服务商的子服务商（渠道商、代理等）相关信息，具体如下：

 ![](https://mc.qcloudimg.com/static/img/82d5ff1ecd59af665a319f2f45d9a312/image.png)

参数说明：

- 腾讯云帐号：子服务商登录腾讯云的帐号，必须是QQ号。
- 公司：子服务商公司名称。
- 返佣比例：服务商给子服务商的返佣分成比例。
- 备注：描述信息等。
- 返回结果：是否成功，成功则提示成功，失败则提示失败原因。

## 添加微信支付子商户
- 服务商需先在[微信支付商户平台](https://pay.weixin.qq.com)，完成微信支付子商户申请，然后在[云支付](https://console.qcloud.com/cpay)的子商户管理页面，点击添加子商户，按要求填入相关信息，具体如下：
- 添加子商户基本信息

 ![](https://mc.qcloudimg.com/static/img/10f230d047262470ade9bcc3f47b0fdd/image.png)

参数说明：

- 服务商商户号：微信支付服务商平台上的微信支付商户号，服务商在申请微信支付后，由微信支付分配的商户收款账号。 [查看](https://pay.weixin.qq.com/index.php/core/account/info)
- 子商户帐号：微信支付商户平台上的微信支付商户号，子商户在申请微信支付后，由微信支付分配的商户收款账号。 [查看](https://pay.weixin.qq.com/index.php/core/account/info)
- 子商户名称：微信支付商户平台上的商户名称。
- 子商户AppID：商户的微信公众号AppID（应用ID），子商户可在微信公众平台-->开发者中心查看，商户的微信支付审核通过邮件中也会包含该字段值。 [查看](https://mp.weixin.qq.com)
- 子商户备注：子商户备注信息。

- 添加完成后，点击下一步

 ![](https://mc.qcloudimg.com/static/img/67b320e4d51fe16a40a69bf9c070b69c/image.png)

参数说明：

- 认证类型：认证码生成算法。
- 认证密钥：用于交易请求时对参数生成认证码。
- 签名类型：签名算法。
- 验签公钥：用户撤单和退款时服务端验签。
- 签名私钥：用于撤单和退款时客户端签名。
- 返回结果：是否成功，成功则提示成功，失败则提示失败原因。

- 点击签名私钥后的复制，保存认证密钥和签名私钥到本地。

参数来源如图所示：

 ![](https://mc.qcloudimg.com/static/img/d2e87f72fa4f88ed9f4a21cc04f1c487/image.png)

## 商户配置门店信息
- 商户可以调用SDK完成门店信息配置，包括门店编号，门店内终端编号，门店内店员编号, 然后全量或增量同步到云支付。
