## Java 安装与配置
JDK 是 Java 软件开发工具包，是开发 Java 程序的工具包。
本文以 JDK 1.7 和1.8 版本为例，分别介绍了 Windows 和 Linux 系统下 JDK 的安装与环境配置过程。

### Windows
#### 1.下载 JDK
进入 [Oracle 官方网站](http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html) 下载合适的 JDK 版本，准备安装。

#### 2. 安装
根据提示一步步安装，安装过程中可以自定义安装目录(默认安装到 C 盘)，例如我们选择的安装目录为：
`D:\Program Files\Java\jdk1.8.0_31`
`D:\Program Files\Java\jre1.8.0_31`
![本地同步工具1](//mc.qcloudimg.com/static/img/0652f9759c4f7fa7e61aa406ca1ad822/image.png)

#### 3. 配置
安装完成后，右键单击【计算机】> 单击【属性】>【高级系统设置】>【环境变量】>【系统变量】>【新建】，分别配置软件。
变量名(N)：**JAVA_HOME**   
变量值(V)：D:\Program Files\Java\jdk1.8.0_31    *// 请根据自己的实际安装路径配置*
![本地同步工具2](//mc.qcloudimg.com/static/img/f02f0ec6b87576f32fbade9cd8d55c1e/image.png)
变量名(N)：**CLASSPATH**   
变量值(V)：.;%JAVA_HOME%\lib\dt.jar;%JAVA_HOME%\lib\tools.jar;        *//注意变量值开头有"."*
![本地同步工具3](//mc.qcloudimg.com/static/img/d2c87f5ce4c2927f5e9ca9d20e4478d6/image.png)
变量名(N)：**Path**
变量值(V)：%JAVA_HOME%\bin;%JAVA_HOME%\jre\bin;
![本地同步工具4](//mc.qcloudimg.com/static/img/5ee8cc105d52f9052cc49251ce88ed9a/image.png)

#### 4. 测试
测试配置是否成功：【开始】（或快捷键：Win+R）>【运行】（输入 `cmd`）>【确定】（或按 Enter 键），输入命令 `javac` 并回车。出现如下图所示信息，则说明环境变量配置成功。
![本地同步工具5](//mc.qcloudimg.com/static/img/83f8417d6f540c20182267acba29f2ad/image.png)

### Linux
- [CentOS yum 安装 JDK](#CentOS)
- [手动解压安装 JDK ](#手动安装)
- [Ubuntu 上使用 apt-get 安装 JDK](#Ubuntu)

<span id="CentOS"></span>
#### CentOS yum 安装 JDK
1. 查看 yum 库中的 Java 安装包
```
yum -y list java*
```
![115032](//mc.qcloudimg.com/static/img/33f0d3fb25afa842a4ced99acebeb050/image.png)
2. 使用 yum 安装 Java 环境
```
//选择1.7版本进行安装 
[root@localhost ~]# yum install java-1.7.0-openjdk 
//安装完之后，默认的安装目录是在: /usr/lib/jvm/java-1.7.0-openjdk-1.7.0.75.x86_64 
```
3. 设置环境变量
```
[root@localhost ~]# vi /etc/profile 
```
在 profile 文件中添加如下内容：
```
#set java environment JAVA_HOME=/usr/lib/jvm/java-1.7.0-openjdk-1.7.0.75.x86_64 JRE_HOME=$JAVA_HOME/jre CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin export JAVA_HOME JRE_HOME CLASS_PATH PATH 
```
让修改生效：
```
[root@localhost java]# source /etc/profile 
```
4. 测试配置是否成功
输入`java -version`可查看 Java 版本；输入`javac`可查看 Java 的编辑器命令用法。
![120405](//mc.qcloudimg.com/static/img/5c989198e9145596436e6f1d63c57f71/image.png)

<span id="手动安装"></span>
#### 手动解压安装 JDK 
1. 在`/usr/`目录下创建`java`目录。
```
[root@localhost ~]# mkdir/usr/java [root@localhost ~]# cd /usr/java 
```
2. 下载 JDK，然后解压。
```
[root@localhost java]# curl -O http://download.oracle.com/otn-pub/java/jdk/7u79-b15/jdk-7u79-linux-x64.tar.gz [root@localhost java]# tar -zxvf jdk-7u79-linux-x64.tar.gz 
```
3. 设置环境变量。
```
[root@localhost java]# vi /etc/profile 
```
在 profile 中添加如下内容：
```
#set java environment JAVA_HOME=/usr/java/jdk1.7.0_79 JRE_HOME=/usr/java/jdk1.7.0_79/jre CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin export JAVA_HOME JRE_HOME CLASS_PATH PATH 
```
让修改生效：
```
[root@localhost java]# source /etc/profile 
```
4. 测试配置是否成功
```
[root@localhost java]# java -version java version "1.7.0_79" Java(TM) SE Runtime Environment (build 1.7.0_79-b15) Java HotSpot(TM) 64-Bit Server VM (build 24.79-b02, mixed mode) 
```

<span id="Ubuntu"></span>
#### Ubuntu 上使用 apt-get 安装 JDK
1. 查看 apt 库都有哪些 JDK 版本。
```
root@Itble:~# apt-cache search java|grep jdk 
```
2. 选择版本进行安装。
```
root@Itble:~# apt-get install openjdk-7-jdk 
```
3. 设置环境变量。
```
root@Itble:~# vi /etc/profile 
```
在打开的 profile 文件中添加如下内容：
```
#set java environment JAVA_HOME=/usr/lib/jvm/java-1.7.0-openjdk-amd64 JRE_HOME=$JAVA_HOME/jre CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin export JAVA_HOME JRE_HOME CLASS_PATH PATH 
```
让修改生效：
```
root@Itble:~# source /etc/profile 
```
4. 测试配置是否成功（同 CentOS yum 方法）。
输入`java -version`可查看 Java 版本；输入`javac`可查看 Java 的编辑器命令用法。

## Python 安装与环境配置
本章节以 Python 2.7 版本为例，详细介绍 Windows 和 Linux 系统下 Python 的安装与环境配置过程。

### Windows
#### 1. 下载
进入 [ Python 官网](https://www.python.org/downloads/) 选择合适的版本下载，本示例中我们选择下载 [Python 2.7.13](https://www.python.org/ftp/python/2.7.13/python-2.7.13.amd64.msi) 版本。

#### 2. 安装
下载好 Python 安装包后双击 Python 安装包，按照默认提示，一步步进行安装。

#### 3. 环境变量配置
安装完成后，右键单击【计算机】>单击【属性】>【高级系统设置】>【环境变量】>【系统变量(S)】 找到 “Path” （没有就新建），并在 “变量值” 末尾添加 Python 的安装路径：`;C:\Python27`（请更改为您的安装路径），单击【确定】保存。
![161709](//mc.qcloudimg.com/static/img/b5784ed03d0f2fd07195c9c3ae1e5075/image.png)

#### 4. 测试配置是否成功
单击【开始】（或快捷键：Win+R）>【运行】（输入 `cmd`）>【确定】（或者按 Enter 键），在弹出的窗口中输入命令 `javac`并回车。出现以下信息，说明 Python 2.7 已经安装配置好：
![122116](//mc.qcloudimg.com/static/img/83f8417d6f540c20182267acba29f2ad/image.png)

### Linux
#### 1. 查看 Python 版本 
Linux 的 yum 自带 Python，首先查看默认 Python 版本
```
python -V
``` 
若已经是 Python 2.7 及以上版本，则忽略以下步骤；否则（此处假设现有版本为 Python 2.6.6），输入以下命令：
```
yum groupinstall "Development tools"
```

#### 2. 安装编译 Python 需要的组件
```
yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel
```

#### 3. 下载并解压 Python 2.7 
```
wget https://www.python.org/ftp/python/2.7.12/Python-2.7.12.tar.xz //下载
tar xf Python-2.7.12.tar.xz  //解压
```

#### 4. 编译与安装 Python
```
   cd Python-2.7.12 //进入目录
   ./configure –prefix=/usr/local
   make && make install //安装
   make clean 
   make distclean
```

#### 5. 将系统 Python 命令指向 Python 2.7
```
   mv /usr/bin/python /usr/bin/python2.6.6
   ln -s /usr/local/bin/python2.7 /usr/bin/python
```

#### 6. 测试配置是否成功
```
   python
```
出现以下信息，说明 Python 2.7 已经安装配置好：
![112046](//mc.qcloudimg.com/static/img/0eb560566c1f67e302e75b1dcb515d98/image.png)


> <font color="#0000cc">**注意：** </font>
如果出现权限的问题，建议在命令前添加 sudo 尝试解决。

## Hadoop 安装与测试
Hadoop 工具依赖 Hadoop-2.7.2 及以上版本，实现了以腾讯云 COS 作为底层存储文件系统运行上层计算任务的功能。启动 Hadoop 集群主要有单机、伪分布式和完全分布式等三种模式，本文主要以 Hadoop-2.7.4 版本为例进行 Hadoop 完全分布式环境搭建及 wordcount 简单测试介绍。

### 准备环境
#### 安装
1. 准备若干台机器。
2. 安装配置系统：[CentOS-7-x86_64-DVD-1611.iso](http://mirrors.tuna.tsinghua.edu.cn/centos/7/isos/x8664/CentOS-7-x86_64-DVD-1611.iso)。
3. 安装 JAVA 环境：[jdk-8u144-linux-x64.tar.gz](http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/jdk-8u144-linux-x64.tar.gz)。
4. 安装Hadoop-2.7.4 包：[hadoop-2.7.4.tar.gz](http://mirrors.tuna.tsinghua.edu.cn/apache/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz)。 

#### 网络配置
使用`ipconfig -a`查看各台机器的 IP，相互 ping 一下，看是否可以 ping 通，同时记录每台机器的 IP。

### 配置 CentOS
#### 配置 hosts
```
# vi /etc/hosts
```
```
编辑内容：
202.xxx.xxx.xxx master
202.xxx.xxx.xxx slave1
202.xxx.xxx.xxx slave2
202.xxx.xxx.xxx slave3
......IP 地址替换为真实 IP
```

#### 关闭防火墙
```
# systemctl status firewalld.service  #检查防火墙状态
# systemctl stop firewalld.service  #关闭防火墙
# systemctl disable firewalld.service  #禁止开机启动防火墙
```

#### 时间同步
```
# yum install -y ntp  #安装ntp服务
# ntpdate cn.pool.ntp.org  #同步网络时间
```

#### 安装配置 JDK
上传 [jdk-8u144-linux-x64.tar.gz](http://download.oracle.com/otn-pub/java/jdk/8u144-b01/090f390dda5b47b9b721c7dfaa008135/jdk-8u144-linux-x64.tar.gz)  安装包到`root`根目录。
```
# mkdir /usr/java
# tar -zxvf jdk-8u144-linux-x64.tar.gz -C /usr/java/
# rm -rf jdk-8u144-linux-x64.tar.gz
```

#### 各个主机之间复制 JDK
```
# scp -r /usr/java slave1:/usr
# scp -r /usr/java slave2:/usr
# scp -r /usr/java slave3:/usr
.......
```

#### 配置各个主机 JDK 环境变量
```
# vi /etc/profile
```
编辑内容：
```
export JAVA_HOME=/usr/java/jdk1.8.0_144
export PATH=$JAVA_HOME/bin:$PATH
exportCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
# source/etc/profile  #使配置文件生效
# java -version  #查看 java 版本
```

#### 配置 SSH 无密钥访问
分别在各个主机上检查 SSH 服务状态：
```
# systemctl status sshd.service  #检查 SSH 服务状态
# yum install openssh-server openssh-clients  #安装 SSH 服务，如果已安装，则不用执行该步骤
# systemctl start sshd.service  #启动 SSH 服务，如果已安装，则不用执行该步骤
```
分别在各个主机上生成密钥：
```
# ssh-keygen -t rsa  #生成密钥
```
在 slave1 上：
```
# cp ~/.ssh/id_rsa.pub~/.ssh/slave1.id_rsa.pub
#scp~/.ssh/slave1.id_rsa.pub master:~/.ssh
```
在 slave2 上：
```
# cp ~/.ssh/id_rsa.pub~/.ssh/slave2.id_rsa.pub
# scp ~/.ssh/slave2.id_rsa.pubmaster:~/.ssh
```
依此类推...
在 master 上：
```
# cd ~/.ssh
# cat id_rsa.pub >> authorized_keys
# cat slave1.id_rsa.pub >>authorized_keys
# cat slave2.id_rsa.pub >>authorized_keys
# scp authorized_keys slave1:~/.ssh
# scp authorized_keys slave2:~/.ssh
# scp authorized_keys slave3:~/.ssh
```

### 安装配置 Hadoop
#### 安装 Hadoop
上传 [hadoop-2.7.4.tar.gz](http://mirrors.tuna.tsinghua.edu.cn/apache/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz) 安装包到`root`根目录。
```
# tar -zxvf hadoop-2.7.4.tar.gz -C /usr
# rm -rf hadoop-2.7.4.tar.gz
# mkdir /usr/hadoop-2.7.4/tmp
# mkdir /usr/hadoop-2.7.4/logs
# mkdir /usr/hadoop-2.7.4/hdf
# mkdir/usr/hadoop-2.7.4/hdf/data
# mkdir /usr/hadoop-2.7.4/hdf/name
```
进入`hadoop-2.7.4/etc/hadoop`目录下，进行下一步操作。

#### 配置 Hadoop
1. 修改`hadoop-env.sh`文件
增加 export JAVA_HOME=/usr/java/jdk1.8.0_144 
2. 修改 `yarn-env.sh`
export JAVA_HOME=/usr/java/jdk1.8.0_144
3. 修改`slaves`
配置内容：
```
删除：localhost
添加：slave1
	 slave2
	 slave3
```
4. 修改`core-site.xml`
```
<configuration>
  <property>
    <name>fs.default.name</name>
    <value>hdfs://master:9000</value>
  </property>
  <property>
    <name>hadoop.tmp.dir</name>
    <value>file:/usr/hadoop-2.7.4/tmp</value>
  </property>
</configuration>
```
5. 修改`hdfs-site.xml`
```
<configuration>
  <property>
    <name>dfs.datanode.data.dir</name>
    <value>/usr/hadoop-2.7.4/hdf/data</value>
    <final>true</final>
  </property>
  <property>
    <name>dfs.namenode.name.dir</name>
    <value>/usr/hadoop-2.7.4/hdf/name</value>
    <final>true</final>
  </property>
</configuration>
```
6. 修改`mapred-site.xml`
```
<configuration>
  <property>
    <name>mapreduce.framework.name</name>
    <value>yarn</value>
  </property>
  <property>
    <name>mapreduce.jobhistory.address</name>
    <value>master:10020</value>
  </property>
  <property>
    <name>mapreduce.jobhistory.webapp.address</name>
    <value>master:19888</value>
  </property>
</configuration>
```
7. 修改`yarn-site.xml`
```
<configuration>
  <property>
    <name>yarn.nodemanager.aux-services.mapreduce.shuffle.class</name>
    <value>org.apache.mapred.ShuffleHandler</value>
  </property>
  <property>
      <name>yarn.nodemanager.aux-services</name>
      <value>mapreduce_shuffle</value>
  </property>
  <property>
    <name>yarn.resourcemanager.address</name>
    <value>master:8032</value>
  </property>
  <property>
    <name>yarn.resourcemanager.scheduler.address</name>
    <value>master:8030</value>
  </property>
  <property>
    <name>yarn.resourcemanager.resource-tracker.address</name>
    <value>master:8031</value>
  </property>
  <property>
    <name>yarn.resourcemanager.admin.address</name>
    <value>master:8033</value>
  </property>
  <property>
    <name>yarn.resourcemanager.webapp.address</name>
    <value>master:8088</value>
  </property>
</configuration>
```
8. 各个主机之间复制 Hadoop
```
# scp -r /usr/ hadoop-2.7.4 slave1:/usr
# scp -r /usr/ hadoop-2.7.4 slave2:/usr
# scp -r /usr/ hadoop-2.7.4 slave3:/usr
```
9. 各个主机配置 Hadoop 环境变量
```
# vi /etc/profile
编辑内容：
export HADOOP_HOME=/usr/ hadoop-2.7.4
export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH
export HADOOP_LOG_DIR=/usr/hadoop-2.7.4/logs
export YARN_LOG_DIR=$HADOOP_LOG_DIR
# source /etc/profile  #使配置文件生效
```

#### 启动 Hadoop
1. 格式化 namenode
```
# cd /usr/hadoop-2.7.4/sbin
# hdfs namenode -format
```
2. 启动
```
# cd /usr/hadoop-2.7.4/sbin
# start-all.sh
```
3. 检查进程
master 主机包含 ResourceManager、SecondaryNameNode、NameNode 等，则表示启动成功，例如：
```
2212 ResourceManager
2484 Jps
1917 NameNode
2078 SecondaryNameNode
```
各个 slave 主机包含 DataNode、NodeManager 等，则表示启用成功，例如：
```
17153 DataNode
17334 Jps
17241 NodeManager
```

### 运行 wordcount
由于 Hadoop 自带 wordcount 例程，所以可以直接调用。
在启动 Hadoop 之后，我们可以通过以下命令来对 HDFS 中的文件进行操作：
```
# hadoop fs -mkdir input
# hadoop fs -put input.txt /input
# hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.4.jar wordcount /input /output/
```
![6762940-439379efda5b4ad6_副本](//mc.qcloudimg.com/static/img/50a03d9e0504301d54d12631cc8da075/image.jpg)
出现如上图结果就说明已经成功了。

查看输出目录：
```
hadoop fs -ls /output
```

查看输出结果：
```
hadoop fs -cat /output/part-r-00000
```
![6762940-623e7b1c1b81cb4c_副本](//mc.qcloudimg.com/static/img/6d777bc87c16b0fb10713bbecda1636d/image.jpg)

> <font color="#0000cc">**注意：** </font>
> 单机模式与伪分布式模式的操作方法的详细过程可以参考官网：[Hadoop入门](https://hadoop.apache.org/docs/r1.0.4/cn/quickstart.html)。
