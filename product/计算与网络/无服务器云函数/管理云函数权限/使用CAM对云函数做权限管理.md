## 权限管理概述
[访问管理（Cloud Access Management，CAM）](https://cloud.tencent.com/document/product/598?)是腾讯云提供的 Web 服务，主要用于帮助客户安全管理腾讯云账户下的资源的访问权限。用户可以通过 CAM 创建、管理和销毁用户（组），并使用身份管理和策略管理控制其他用户使用腾讯云资源的权限。

腾讯云无服务器云函数 SCF 已支持通过访问管理（Cloud Access Management，CAM）进行权限管理，用户可以通过主账号给子账号或者协作者赋予不同的权限。当前 SCF 支持的权限粒度如下：

| 服务 | 策略语法 |  云 API | 控制台 | 授权粒度 | 临时证书| 
| ---------| ---------| ---------| ---------|---------|---------|
| 无服务器云函数 | ✔ | ✔ | ✔ | 资源级 | ✔|

当前 SCF 支持的云 API 接口如下：

| 接口名称  | 描述 | 级别 |
|---------|---------|---------|
| ListFunctions | 获取账号下的函数列表|账号级 |
| GetAccountSettings| 获取账号下的限额配置|账号级 |
| CreateFunction| 新建一个新函数| 资源级|
| DeleteFunction| 删除指定的函数| 资源级|
| InvokeFunction| 触发函数，分为同步和异步触发| 资源级|
| UpdateFunction| 更新函数，包括配置和/或代码| 资源级|
| SetTrigger    | 对指定函数配置触发器| 资源级|
| DeleteTrigger | 删除指定函数的触发器| 资源级|
| GetFunction   | 获取指定函数的配置信息| 资源级|
| ListVersion   | 获取指定函数的版本信息| 资源级|
| GetFunctionLogs | 获取指定函数的日志信息| 资源级|
>**注意：**
在配置策略语法时，还需要配合使用 monitor 相关的接口以获得账号下的监控信息，使用方法请参考下面的策略样例。

SCF 的策略语法遵循 CAM 的 [语法结构](https://cloud.tencent.com/document/product/598/10604) 和 [资源描述方式](https://cloud.tencent.com/document/product/598/10606)，策略语法以 JSON 格式为基础，所有资源均可采用下述的六段式描述方式，示例如下：
```
qcs: :scf:region:uin/uin—id:function/function-name
```
<a id="code"></a>
### 策略样例
```
{	 
        "version":"2.0", 
        "statement": 
        [ 
           { 
              "effect":"allow", 
              "action":
              [
                "scf:ListFunctions",
                "scf:GetAccountSettings"，
                "monitor:*"
              ], 
              "resource":["*"]  
           }, 
          { 
             "effect": "allow",
             "action": 
             [
                "scf:DeleteFunction",
                "scf:CreateFunction",
                "scf:InvokeFunction",
                "scf:UpdateFunction",
                "scf:GetFunctionLogs",
                "scf:SetTrigger",
                "scf:DeleteTrigger",
                "scf:GetFunction",
                "scf:ListVersion"
            ],
            "resource": 
            [
                "qcs::scf:gz:uin/******:function/Test1",
                "qcs::scf:gz:uin/******:function/Test2"
            ]
         }
      ] 
} 
```
* 操作（action）是需要关联资源的操作时，resource 定义为`*`，表示关联所有资源。

* 操作（action）是不需要关联资源的操作时，resource都需要定义为`*`。

* 该样例可以实现子账号拥有主账号下某些函数的操作权限，resource 中的资源描述为主账号下的某个函数。

## 示例一 ：创建子用户并授权 SCF 的所有操作权限
<a id="step1"></a>
### 步骤一：使用主账号创建子用户
1. 登录 [访问管理控制台](https://console.cloud.tencent.com/cam/overview)，进入左侧导航 **用户管理** 页面，单击【新建用户】 > 【子用户】，进入创建页面。

2. 填写用户信息。您可批量创建子用户，设置访问类型和控制台密码等，请根据您的需要进行设置。

3. 设定权限（必选）。请根据不同的业务场景进行合适的设定，单击【下一步】保存设定，后续您可以更改相关权限设定。权限的三种设置方式：
 - 将子用户添加到现有用户组或新建用户组；
 - 复制现有用户权限；
 - 从策略列表中授权。

4. 完成创建，控制台显示子用户的用户名、密码、云 API 密钥等相关信息，请单击【完成】退出页面。

相关文档参考： [创建子用户](https://cloud.tencent.com/document/product/598/13674)

<a id="step2"></a>
### 步骤二：创建自定义策略
1. 单击左侧导航栏【策略管理】进入 **策略管理** 页面，单击【新建自定义策略】>【按策略生成器创建】，进入创建页面。

2. 选择服务和操作。
按以下内容设置对应项目，单击【添加声明】>【下一步】，进入编辑策略步骤：
 - 效果：允许
 - 服务：无服务器云函数
 - 操作：全部
 - 资源描述：`*`
 - 条件（可选）置空

3. 编辑策略名称和备注（建议修改为便于理解的策略名称），单击【创建策略】完成策略创建。

### 步骤三：把策略关联到用户/用户组
1. 在策略管理页面，单击新建策略右侧的【关联用户/组】，弹出关联提示框。

2. 选择需要关联的用户，单击【确定】完成关联操作。您还可以切换用户或用户组，进行选择。

### 完成
以上设置完成后，用户可以登录子账号查看权限。在左侧的导航栏中单击【概览】进入概览页面，可以查看子用户登录地址。

## 示例二 ：创建子用户并授权部分函数的操作权限
### 步骤一：使用主账号创建子用户
请参考示例一的 [步骤一](#step1)。

### 步骤二：创建自定义策略
请参考示例一 [步骤二](#step2) 的步骤 1 到 2，第 3 步进入编辑策略步骤后，请编辑策略名称和备注（建议修改为便于理解的策略名称），并对策略内容进行修改，替换成上文 [策略样例](#code) 中的代码。
>**注意：**
>resource 中的资源描述，需要替换成主账号的 ID 和主账号下函数名，region 需要和函数保持一致。

###  步骤三：把策略关联到用户/用户组
1. 在策略管理页面，单击新建策略右侧的【关联用户/组】，弹出关联提示框。

2. 选择需要关联的用户，单击【确定】完成关联操作。您还可以切换用户或用户组，进行选择。

### 完成
以上设置完成后，用户可以登录子账号查看权限。在左侧的导航栏中单击【概览】进入概览页面，可以查看子用户登录地址。**策略生效后，当前子账号可以看到所有的函数名，但是只能对 resource 中的函数进行操作和查看。**
