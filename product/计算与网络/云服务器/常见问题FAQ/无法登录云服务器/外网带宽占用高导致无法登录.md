### 1. Linux 服务器
由于外网带宽使用率会影响 SSH 连接，当外网带宽占用过高时，SSH 登录服务器时可能会出现速度缓慢、卡顿等情况。建议通过管理页面中**登录**按钮登录主机进行确认。

登录主机后，执行  ` yum install iftop -y ` 语句安装 iftop 工具。iftop工具为 Linux 下监控服务器流量的小工具。
>如果是Ubuntu系统，请执行 `apt-get install iftop -y` 语句。

安装完毕后，执行 iftop。iftop 会展示出消耗流量的 IP 。
![](https://mc.qcloudimg.com/static/img/5ee394bbba0e569e1cc9eab5127b7769/3.png)

根据 iftop 中消耗流量的 IP，执行 `lsof -i | grep ip` 语句来查看连接该 IP 的进程。
![](https://mc.qcloudimg.com/static/img/fa829adea82ec701049f9c043646625e/4.png)
此示例截图中可以看到，此服务器外网带宽主要由 SSH 进程消耗。

在实际排查的过程中，须重点关注消耗带宽的进程是否为正常业务进程：
- 如果是正常业务进程，我们需要针对业务行为以及业务日志进行分析；
- 如果是非正常业务进程，我们则需要提高安全意识，因为极有可能是因为服务器出现安全漏洞而被入侵植入木马导致。

>建议重点核查目的端 IP 归属地，可以通过 [ip138查询网站](ip138.com) 进行 IP 归属地查询。如果发现目的端 IP 归属地为国外，则安全隐患更大，请务必重点关注！

### 2. Windows服务器
在外网带宽占用高时，建议使用控制台网页来登录主机。Windows 系统下可以使用系统自带资源管理器查看带宽使用情况。

打开任务管理器：
>或者在桌面执行【开始】—>【运行】—>输入 `taskmgr` 语句。

![](https://mc.qcloudimg.com/static/img/93371bb22a4e0b86c8677951acc18a96/5.png)
根据消耗带宽的进程来进行判断：
- 如果是正常业务进程，则需要针对分析。
- 如果是非正常业务进程 ，则需要提高安全意识，判断是否是由于被入侵所导致。

>注：Windows 下很多病毒程序会伪装成系统进程，可以通过【任务管理】—>【进程】中的进程信息来进行初步鉴别。
- 正常的系统进程都会有完整的签名以及介绍，并且多数位于 C:\Windows\System32 目录下；
- 病毒程序尽管名字和系统进程一样，但是缺少签名以及描述，位置也会比较不寻常。
