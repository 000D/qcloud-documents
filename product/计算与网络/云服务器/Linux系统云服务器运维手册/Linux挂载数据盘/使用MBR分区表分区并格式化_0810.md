>**注意：**
>本文提及的方法仅适用于容量不超过 2TB 的硬盘进行分区及格式化。大于 2TB 的硬盘请使用 GPT 方式，可参阅 [使用 GPT分区表分区并格式化](https://www.qcloud.com/document/product/213/2043)。

新购买的 Linux 云服务器，数据盘未做分区和格式化，无法使用。
用户可以通过 **脚本格式化** 和 **手动格式化** 两种方式对 Linux 云服务器数据盘进行格式化操作。
>**注意：**
>数据盘中的数据在格式化后将全部被清空。请在格式化之前，确保数据盘中没有数据或已对重要数据进行备份。为避免服务发生异常，格式化前请确保云服务器已停止对外服务。

## 脚本格式化
>**注意：**
>本脚本格式化方法仅适用于默认用户名为 root 的机器。默认用户名为 ubuntu 的机器，请采用手动格式化。 
>ubuntu 操作系统请通过手动格式化方式对数据盘进行格式化操作。

1. 将需要进行数据盘格式化操作的云主机的 IP ，SSH 端口号和 root 账号的密码写到 hosts.txt 文件中，每一行代表一个主机，比如：


## 手动格式化
请根据下述步骤对数据盘进行分区以及格式化，并挂载分区使数据盘可用。
>**注意：**
>1. 执行以下命令时，请注意修改数据盘符，可以使用`fdisk -l`查看盘符等相关信息。以下均以 vdb 为例，若是其他盘符，仅需将 vdb 替换为该盘符即可。如盘符为 xvbd，则 fdisk /dev/vdb 替换为 fdisk /dev/xvdb。
>2. 请确认路径正确,若错填为 /dev/vda ,将会造成云主机崩溃。

### 1. 查看数据盘信息 
登录 Linux 云服务器后，使用`fdisk -l`命令查看数据盘相关信息。
>**注意：**
>若使用`df -h`命令，则无法查看到未分区和格式化的数据盘信息。
![](https://mc.qcloudimg.com/static/img/9b86a3120ed4e2178ca5bb6e7ac0a9d0/33.png)

### 2. 数据盘分区
执行命令`fdisk /dev/vdb`对数据盘进行分区。
按照界面的提示，依次键入`n`(新建分区)、`p`(新建扩展分区)、`1`(使用第 1 个主分区)，两次回车(使用默认配置)，键入`w`(保存分区表)，开始分区。
此处以创建 1 个分区为例，开发者也可以根据自己的需求创建多个分区。 
![](https://mc.qcloudimg.com/static/img/84539d5019c088708e332afe31883e72/34.png)

### 3. 查看新分区
执行`fdisk -l`命令，即可查看到，新的分区 vdb1 已经创建完成。
![](https://mc.qcloudimg.com/static/img/58a94efb5580b7124f80a5dca4f9cc79/35.png)

### 4. 格式化新分区
>**注意：**
>在进行分区格式化时，开发者可以自行决定文件系统的格式，如 ext2、ext3 等。本例使用的格式为`ext3`。

执行命令`mkfs.ext3 /dev/vdb1`对新分区进行格式化。 
![](https://mc.qcloudimg.com/static/img/8d2ff6a71bef519b85a46976e3f30a5b/36.png)

### 5. 挂载新分区
1). 执行命令`mkdir /mydata`创建 mydata 目录。
2). 执行命令`mount /dev/vdb1 /mydata`手动挂载新分区。
3). 最后执行`df -h`命令查看分区信息。
出现如图示信息则说明挂载成功，即可以查看到数据盘了。
![](https://mc.qcloudimg.com/static/img/af3153a57ac242ce199237246686b855/37.png)

### 6. 添加分区信息
如果希望云服务器在重启或开机时能自动挂载数据盘，必须将分区信息添加到`/etc/fstab`中。如果没有添加，则云服务器重启或开机后，都不能自动挂载数据盘。
>**注意：**
>请确认分区路径是否为 `/dev/vdb1`,若路径错误，将会造成云主机重启失败。

先执行以下命令添加分区信息：
```
echo '/dev/vdb1 /mydata ext3 defaults 0 0' >> /etc/fstab
```

再使用命令`cat /etc/fstab`查看分区信息。
出现如图示信息则说明添加分区信息成功。
![](https://mc.qcloudimg.com/static/img/2b6f0277d5e0a075b6a3b0c8bfb136f0/38.png)
