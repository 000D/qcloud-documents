## 功能相关问题 ##
### 1.云通信功能介绍
__功能介绍__ 


----------


 __平台支持__ 

支持 Android/iOS/Windows C++/Web

支持 Android/iOS/Windows C++/Web 等主流平台互通，跨终端全平台的服务。


----------


 __账号集成__ 

 __独立模式__ 

- 支持自有账号；
- 支持第三方账号（支持 QQ，微信，新浪微博等第三方登录账号）；
- 匿名（支持匿名/游客模式登录）；

__托管模式__ 

- 支持自有账号；
- 支持第三方账号（支持QQ，微信，新浪微博等第三方登录账号）；
- 匿名（支持匿名/游客模式登录）；


----------


 __支持会话类型__ 

__会话类型__ 

- 单聊；
- 群聊（支持公有群/聊天室/讨论组/直播聊天室）；

__会话获取__ 

发消息时首先需要先获取会话，获取会话需要指定会话类型（群组&单聊）。

 __会话删除__ 

仅删除会话记录，会话中的消息并未删除。


----------


 __用户管理__ 

 __用户状态__ 

- 用户登录状态：登录和注销状态；
- 用户在线状态：在线和离线状态（以用户登录为前提）；

__用户资料管理__ 

- 昵称；
- 头像；
- 设置好友验证方式；


----------

 __关系链管理__ 

 __关系链管理__ 

![图片描述](//bot1024-1253841380.file.myqcloud.com/cecd3a7e2be511e8a6b45254000ab150.png)

 __关系链事件通知__ 

-  __关系链变更系统通知：__ 
添加/删除好友系统通知；
好友申请系统通知；
删除未决请求通知 ；
好友资料变更系统通知；

__黑名单__ 

- 加入/移除黑名单

__联系人管理__ 

-  __最近联系人__ ：
最近联系人漫游
最近联系人删除


----------
 __消息类型__ 

 __消息类型（文本，图片，语音，表情等自定义消息）：__ 

- 文本：最大 1~2k 字节（支持透传特殊字符）；
- 图片：原图/缩略图/大图（支持格式：png/gif/jpeg/jpg/webp）；
- 语音：异步语音消息（语音支持暂无上限）；
- 表情等自定义消息。

__消息类型（位置，表情，消息组合，自定义消息）：__ 

- 位置：传递经纬度和描述；
- 小文件：暂支持 28M 以下小文件信息；
- 微视频：支持微视频消息；
- 内容组合：支持自定义消息（由一种或多种类型消息组合而成）；
- 自定义消息：可以扩展加入任何类型的消息。

__系统消息__ 

支持在线状态的消息 push。

 __离线消息__ 

支持离线是消息 push。

 __消息推送__ 

支持后台全员推送消息给用户。


----------


 __消息管理__ 

 __消息状态__ 

- 发送状态：发送成功/失败/发送中
- 已读状态：用户阅读某个会话后，应用需上报消息已读，SDK 会设置该会话之前的所有消息为已读；
 
__消息缓存__ 

- SDK 会缓存消息内容 （成功或失败都会缓存），消息缓存本地。
- 对图片、语音等资源类消息，消息体只会包含描述信息，需调用接口下载数据（如有缓存本地需求，需应用研发支持）。

__消息获取__ 

- 异步获取消息：通过设置回调得到消息数据。
- 实时消息同步：通过回调接口实时同步消息。

__消息过滤__ 

- 敏感词过滤

__消息删除__ 

使用消息的 remove 方法可以在本地删除消息。

 __未读计数__ 

统计未读消息数量。

 __消息漫游__ 

保存7天消息，保存一定大小的消息，超出滚动。

 __消息拓展属性__ 

可通过接口获取用户部分资料

 __平滑迁移__ 

支持自家和第三方合作的历史版本消息互通。


----------

 __群组管理__ 

 __群组类型__ 

- 支持私有群：允许普通成员修改群组资料、拉人进群，允许群主退出等；
- 公有群：拥有更为严格的群组权限管理机制，类似 QQ 群；
- 聊天室：相对于公有群，聊天室的历史消息可被查看，类似兴趣群；
- 直播聊天室：针对直播场景中参与人数多和消息量大等特点，云通信提供了直播聊天室；

__群组管理__ 

- 新建群组；
- 解散群组：群主可操作；
- 转让群组：只有群主才有权限进行群转让操作；
- 禁言：群主和管理员可对群普通成员做禁言操作；
- 群资料/群简介/群公告/：对于公有群和聊天室，只有群主或者管理员可以修改；对于私有群，任何人可修改；
- 群成员资料：只有群主或者管理员可以进行对群成员的身份进行修改；如设置管理员
- 修改群名片
- 更多功能权限管理：详情请参见“群组功能权限介绍”
 
__用户操作__ 

- 拉用户入群：此操作只对私有群有效；
- 删除群组成员（带原因）：对于私有群：只有创建者可删除群组成员 对于公有群和聊天室：只有管理员和群主可以踢人；
- 邀请入群；
- 邀请入群同意/拒绝消息；
- 用户主动申请加入群组：此操作只对公有群和聊天室有效；
- 申请加群同意/拒绝消息
- 设置/取消管理员
- 退出群组：对于私有群，全员可退出群组； 对于公有群和聊天室，群主不能退出；
 
__群组查找__ 

- 通过群id搜索群
- 通过群名称搜索群
 
__群消息__ 

- 普通消息：请参见“消息管理”内容；
-系统消息；
消息类型：邀请加入群/用户退群/群名称修改；
离线存储时间：7 天；
离线数量上限：100 条；

__群参数上限__ 

- 群数规模：一个业务最多支持 1 亿群组；
- 单群成员数： 单个群组成员数上限为 1 万（注：直播聊天室加入人数无上限）；
- 单用户加入的群个数：每个用户加群上限为 5 千；

__群资料托管__ 

- 群资料托管空间；
- 群成员资料托管空间；
 
__获取信息__ 

- 获取群组成员列表；
- 获取群组成员入群时间；
- 获取加入群组列表；
- 获取群组资料：群组资料字段列表：群名/公告/简介/创建人/创建时间/群成员数量。
 _备注：暂不支持自定义字段_ 
- 获取群组公开资料：当用户不在群组时，需要通过接口获取群的公开资料。

详情请参考： [云通信功能介绍](https://cloud.tencent.com/document/product/269/1499)

### 2.云通信如何做聊天置顶功能?
目前ImSDK版本不支持聊天置顶功能，不过APP层很容易做到，如果用户选择某个会话置顶，可以由APP层记录会话的 type 和 receiver 信息，显示会话的时候，需要把对应会话置顶显示，下面获取到会话列表后，需要过滤掉对应的会话，避免重复显示。置顶会话和普通会话拼接起来即可。

### 3.云通信如何复制一条消息?
用户选中并复制消息时，需要开发者根据用户选中的消息类型构造一个新的消息，如果想复制成文本，可根据消息类型转换转换成自己想要的展示样式。

### 4.云通信图片上传到哪里?
云通信图片存储服务复用QQ遍布全球的IDC接入点，保证各地的用户都能迅速的上传和下载图片，能做到99.9%的成功率。

### 5.云通信如何删除聊天记录？
__1、Server删除消息：__ 

目前云通信IM仅支持删除群内某人的最近若干条消息，但是如果此消息已经接收到客户端，客户端不会同步删除（即不支持消息撤回的功能），详细可参考： [删除指定用户发的消息](https://cloud.tencent.com/doc/product/269/%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E7%94%A8%E6%88%B7%E5%8F%91%E9%80%81%E7%9A%84%E6%B6%88%E6%81%AF) 。

Server不支持单独删除某一条消息，或者某一个会话的消息。

 __2、客户端本地删除__ 

客户端可以支持删除某一条本地消息或者删除整个会话的消息，不过由于可能存在消息漫游，如果从本地数据库直接删除，可能从Server再次拉回，比如最近联系人拉回最后一条消息，此时可以选择禁用最近联系人。另一种方案是设置一个删除标记位，由UI过滤掉相应删除掉的消息。

详细接口和使用场景可参考：

-  [Android 删除单条消息](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88Android%20SDK%EF%BC%89#3.6-.E6.B6.88.E6.81.AF.E5.88.A0.E9.99.A4) 
-  [Android 删除会话消息](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88Android%20SDK%EF%BC%89#4.5-.E5.88.A0.E9.99.A4.E4.BC.9A.E8.AF.9D) 
-  [iOS 删除单条消息](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88iOS%20SDK%EF%BC%89#3.6-.E6.B6.88.E6.81.AF.E5.88.A0.E9.99.A4) 
-  [iOS 删除会话消息](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88iOS%20SDK%EF%BC%89#4.5-.E5.88.A0.E9.99.A4.E4.BC.9A.E8.AF.9D) 
-  [Windows 删除单条消息](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88Windows%20SDK%EF%BC%89#3.6-.E6.B6.88.E6.81.AF.E5.88.A0.E9.99.A4) 
-  [Windows 删除会话消息](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88Windows%20SDK%EF%BC%89#4.5-.E5.88.A0.E9.99.A4.E4.BC.9A.E8.AF.9D) 

TIMConversation对象提供deleteLocalMessage方法，保留会话记录同时删除本地消息。

如果要清空本地所有聊天记录，可以遍历整个会话列表，TIMManager getConversationList，对每个会话分别调用删除所有消息的方法即可。

### 6.云通信不同终端表情如何互通？
表情使用方式有两种方式：

一种是使用TIMFaceElem中的index，标识表情的索引，比如android和ios两端都有同一套表情图，索引2为笑脸，index=2就表示笑脸，两端发送和接收都显示同一张索引表情图片即可
另一种是使用TIMFaceElem中的data，比如表情图片是由字符串命名，smile表示笑脸，可在data中存储smile，ios和android两端都通过data作为key找到对应表情图片进行显示

另外也可以两个字段都使用，如data表示哪一套表情，index表示这套表情的哪个索引，可以实现类似QQ的多种不同表情效果。甚至可以在data数据中存储更为复杂的数据结构，只要多端解析规则一致即可。

### 7.云通信消息如何定义脏字？
云通信的脏字集中已经涵盖了一批默认脏字（政治、色情等领域），如果用户发送消息命中脏字，会返回失败，错误码80001，脏字说明详细可参考： [背景](https://cloud.tencent.com/doc/product/269/2396#1-.E8.83.8C.E6.99.AF.E8.AF.B4.E6.98.8E) .

另外用户可通过接口自定义脏字，参考： [自定义脏字](https://cloud.tencent.com/doc/product/269/2397)

### 8.云通信如何实现阅后即焚消息？
目前ImSDK并未原生支持阅后即焚消息，如果用户需要此功能，可以使用自定义消息，在APP收到消息并展示给用户之后，调用删除接口删除消息，参见 [删除消息](https://cloud.tencent.com/doc/product/269/4167#.E5.A6.82.E4.BD.95.E5.88.A0.E9.99.A4.E8.81.8A.E5.A4.A9.E8.AE.B0.E5.BD.95.EF.BC.9F) ，也可以使用消息的自定义字段，标记此消息为已经查看的消息。注意这里只是删除的本地显示，如果开启漫游消息，更换终端还是有可能会看到，如果对此信息非常敏感，严格需要只显示一次，可以在自定义消息中添加索引，消息内容从自己的服务器获取，获取过一次以后便删除。

### 9.云通信如何实现消息撤销和已读回执？
目前ImSDK并未原生支持消息撤销和已读回执，可以使用自定义消息构建协议，参见 [消息撤销和已读回执](https://cloud.tencent.com/doc/product/269/6419) 。

### 10.云通信如何获取用户的头像和昵称？
1、 __通用方法__ ：通过 TIMFriendshipManager::GetUsersProfile 方法可以获取任何人的资料；

详细可参考：

-  [Android 获取任何人资料](https://cloud.tencent.com/doc/product/269/%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99%E4%B8%8E%E5%85%B3%E7%B3%BB%E9%93%BE%EF%BC%88Android%20SDK%EF%BC%89#3.3-.E8.8E.B7.E5.8F.96.E4.BB.BB.E4.BD.95.E4.BA.BA.E7.9A.84.E8.B5.84.E6.96.99) 
- [iOS 获取任何人资料](https://cloud.tencent.com/doc/product/269/%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99%E4%B8%8E%E5%85%B3%E7%B3%BB%E9%93%BE%EF%BC%88iOS%20SDK%EF%BC%89#3.3-.E8.8E.B7.E5.8F.96.E4.BB.BB.E4.BD.95.E4.BA.BA.E7.9A.84.E8.B5.84.E6.96.99) 
-  [Windows 获取任何人资料](https://cloud.tencent.com/doc/product/269/%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99%E4%B8%8E%E5%85%B3%E7%B3%BB%E9%93%BE%EF%BC%88Windows%20SDK%EF%BC%89#3.3-.E8.8E.B7.E5.8F.96.E4.BB.BB.E4.BD.95.E4.BA.BA.E7.9A.84.E8.B5.84.E6.96.99) 

2、 __好友关系__ ：如果用户是好友关系，并且开启了好友缓存，可以使用同步接口获取，降低复杂度；

详细可参考：

-  [Android 资料缓存](https://cloud.tencent.com/doc/product/269/%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99%E4%B8%8E%E5%85%B3%E7%B3%BB%E9%93%BE%EF%BC%88Android%20SDK%EF%BC%89#7.-.E5.85.B3.E7.B3.BB.E9.93.BE.E8.B5.84.E6.96.99.E5.AD.98.E5.82.A8) 
-  [iOS 资料缓存](https://cloud.tencent.com/doc/product/269/%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99%E4%B8%8E%E5%85%B3%E7%B3%BB%E9%93%BE%EF%BC%88iOS%20SDK%EF%BC%89#7.-.E5.85.B3.E7.B3.BB.E9.93.BE.E8.B5.84.E6.96.99.E5.AD.98.E5.82.A8) 
-  [Windows 资料缓存](https://cloud.tencent.com/doc/product/269/%E7%94%A8%E6%88%B7%E8%B5%84%E6%96%99%E4%B8%8E%E5%85%B3%E7%B3%BB%E9%93%BE%EF%BC%88Windows%20SDK%EF%BC%89) 

3、 __群消息__ ：对于单聊消息，可以根据情况通过1、2两种方式获取，对于群消息，由于群内成员过多，而且没有资料更新通知，使用1方法复杂度较高，在群消息体内可以直接获取用户资料显示，此资料为用户发送消息当时的状态，后续变更的话，消息内的资料不会变更。

详细可参考：

-  [Android 消息发送者资料](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88Android%20SDK%EF%BC%89#3.4-.E6.B6.88.E6.81.AF.E5.8F.91.E9.80.81.E8.80.85.E5.8F.8A.E5.85.B6.E7.9B.B8.E5.85.B3.E8.B5.84.E6.96.99) 
-  [iOS 消息发送者资料](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88iOS%20SDK%EF%BC%89#3.4-.E6.B6.88.E6.81.AF.E5.8F.91.E9.80.81.E8.80.85.E4.BB.A5.E5.8F.8A.E7.9B.B8.E5.85.B3.E8.B5.84.E6.96.99) 
-  [Windows 消息发送者资料](https://cloud.tencent.com/doc/product/269/%E6%B6%88%E6%81%AF%E6%94%B6%E5%8F%91%EF%BC%88Windows%20SDK%EF%BC%89#3.4-.E6.B6.88.E6.81.AF.E5.8F.91.E9.80.81.E8.80.85.E4.BB.A5.E5.8F.8A.E7.9B.B8.E5.85.B3.E8.B5.84.E6.96.99)

### 11.云通信语音未读红点显示如何实现？
语音是否已经播放，可使用 消息自定义字段 实现，如 customInt 的值 0 表示未播放，1表示播放，当用户点击播放后可设置 customInt 的值为1。

### 12.云通信如何校验好友API？
您好，有关云通信校验好友的REST API请点击 [这里](https://cloud.tencent.com/document/product/269/1646) 查看。

### 13.云通信是否支持添加黑名单？
每个用户都有一份黑名单，可以添加或是删除黑名单，具体请点击 [这里](https://cloud.tencent.com/document/product/269/1501#.E9.BB.91.E5.90.8D.E5.8D.95) 查看。

### 14.云通信是否支持发红包？
云通信SDK未提供发红包的功能，但云通信有自定义消息接口，您可以自己实现发红包的功能。

### 15.云通信如何开启添加好友需要验证？
您好，云通信开启添加好友验证步骤如下：
腾讯云-云通信控制台-应用列表-应用配置-功能配置-消息-编辑：开启“单聊消息检验关系链”即可。

### 16.云通信多终端同时在线是否支持消息的同步?
您好，云通信多终端同时在线支持消息的同步。

### 17.云通信是否可以获取某人的在线状态?
目前客户端ImSDK没有接口获取用户的在线状态，RestAPI可以批量查询，详细参考： [批量获取用户在线状态](https://cloud.tencent.com/doc/product/269/2566)

### 18.云通信是否可以获取当前在线人数？
目前没有接口实时获取APP的在线人数，只可以每天获取上一天的最高在线人数。
