APP 只有在完成信鸽的启动与注册后才可以信鸽 SDK 提供 push 服务，在这之前请确保配置 AccessId 和 AccessKey。

新版的 SDK 已经将启动信鸽和 APP 注册统一集成在注册接口中，即只需调用注册接口便默认完成启动和注册操作。

注册成功后，会返回设备 token，token 用于标识设备唯一性，同时也是信鸽维持与后台连接的唯一身份标识。关于如何获取 token 请参考“获取 token”章节。

注册接口通常提供简版和带 callback 版本的接口，请根据业务需要决定选择接口。

## 绑定设备注册

普通注册只注册当前设备，后台能够针对不同的设备 token 发送推送消息，有2个版本的 API 接口。

注意：这种注册方式，不支持推送帐号。

***（1）原型***
```
public static void registerPush(Context context)
```

***（2）参数***

|名称|描述|是否为null|
 |-|-|-|
| context|当前应用上下文对象|不能为 Null|

***（3）示例***
```
XGPushManager.registerPush(this);
```
另外，为方便用户获取注册是否成功的状态，提供带 callback 的版本。
	
***（1）原型***
```
public static void registerPush(Context context,
final XGIOperateCallback callback)
```

***（2）参数***

|名称|描述|是否为null|
|-|-|-|
|context|当前应用上下文对象|不能为 Null|
|callback|callback 调用，主要包括操作成功和失败的回调|不能为 Null|

***（3）示例***
```
XGPushManager.registerPush(this, new XGIOperateCallback() {
@Override
public void onSuccess(Object data, int flag) {
Log.d("TPush", "注册成功，设备token为：" + data);
}
@Override
public void onFail(Object data, int errCode, String msg) {
Log.d("TPush", "注册失败，错误码：" + errCode + ",错误信息：" + msg);
}
})
```

## 绑定账号注册

绑定账号注册指的是，在绑定设备注册的基础上，使用指定的账号（一个账号可能在多个设备登陆）注册 APP，这样可以通过后台向指定的账号发送推送消息，有2个版本的API接口。

注意：这里的帐号可以是邮箱、QQ 号、手机号、用户名等任意类别的业务帐号。目前一个帐号可以绑定最多15个设备  token，超限后最新的会随机顶掉之前绑定的一个。
***（1）原型***
```
public static void registerPush(Context context, String account)
```
***（2）参数***

|名称|描述|是否为null|
|-|-|-|
|context|当前应用上下文对象|不能为 Null|
|account|绑定的账号，绑定后可以针对账号发送推送消息；如果要按别名推送，那就需要开发者在调用注册接口时把别名设置在注册请求里面的 account 字段，一台设备只允许有一个帐号别名，但一个别名下可以有最多15台设备|不能为 Null|

***（3）示例***

```
XGPushManager.registerPush(this, "UserAccount")
```

另外，为方便用户获取注册是否成功的状态，提供带 callback 的版本。

***（1）原型***
```
public static void registerPush(Context context, String account,
final XGIOperateCallback callback)
```

***（2）参数***

|名称|描述|是否为null|
|-|-|-|
|context|当前应用上下文对象|不能为 null|
|account|绑定的账号，绑定后可以针对账号发送推送消息；如果要按别名推送，那就需要开发者在调用注册接口时把别名设置在注册请求里面的 account 字段，一台设备只允许有一个别名，但一个别名下可以有最多15台设备|不能为 Null|
|callback|callback 调用，主要包括操作成功和失败的回调|不能为 Null|

***（3）示例***
```
XGPushManager.registerPush(this, "UserAccount",
new XGIOperateCallback() {
@Override
public void onSuccess(Object data, int flag) {
Log.d("TPush", "注册成功，设备token为：" + data);
}

@Override
public void onFail(Object data, int errCode, String msg) {
Log.d("TPush", "注册失败，错误码：" + errCode + ",错误信息：" + msg);
}
});
```

## 账号解绑

若 APP 调用 registerPush(context, account）等绑定 account 账号，需要解绑（如用户退出），可以调用以下方法。

调用
```
registerPush(context, "*")或registerPush(context, "*", xGIOperateCallback )
```

即设置 account="*"即为解除之前的账号绑定

>注意：
>账号解绑只是解除 token 与 APP 账号的关联，若使用全量/标签/token 推送仍然能收到通知/消息。

**带登陆态的注册**

考虑到用户的登陆态问题，比如手机 QQ 或 QZone 业务场景，我们提供了带登陆态的注册接口，方便适用该类业务的使用。

***（1）原型***

```
public static void registerPush(Context context, String account,
String ticket, int ticketType, String qua,
final XGIOperateCallback callback)
```


***（2）参数 ***

|名称|描述|是否为null|
|-|-|-|
|context|当前应用上下文对象|不能为null|
|callback|操作回调，主要包括操作成功和失败的回调|不能为null|
|account|绑定的账号，绑定后可以针对账号发送推送消息。如果要按别名推送，那就需要开发者在调用注册接口时把别名设置在注册请求里面的account字段，一台设备只允许有一个别名，但一个别名下可以有15台设备|不能为null|
|ticket|登陆态票据|不能为null|
|ticketType|票据类型quaQZone专用字段|不需要时可填null|

***（3）示例***

```java
XGPushManager.registerPush(this, "UserAccount", "ticket", 1, null,
new XGIOperateCallback() {
@Override
public void onSuccess(Object data, int flag) {
Log.d("TPush", "注册成功，设备 token 为：" + data);
}

@Override
public void onFail(Object data, int errCode, String msg) {
Log.d("TPush", "注册失败，错误码：" + errCode + ",错误信息：" + msg);
}
});
```

## 获取注册结果
有2种途径可以获取注册是否成功。

###  使用callback版本的注册接口

XGIOperateCallback类提供注册成功或失败的处理接口，请参考注册接口里面的示例。
XGIOperateCallback的定义：

```
/**
* 操作回调接口
*/
public interface XGIOperateCallback {
/**
* 操作成功时的回调。
* @param data 操作成功的业务数据，如注册成功时的 token 信息等。
* @param flag 标记码
*/
public void onSuccess(Object data, int flag);
/**
* 操作失败时的回调
* @param data 操作失败的业务数据
* @param errCode 错误码
* @param msg 错误信息
*/
public void onFail(Object data, int errCode, String msg);
}

```

### 重载XGPushBaseReceiver

可通过重载XGPushBaseReceiver的onRegisterResult方法获取。

>注意：
>重载的XGPushBaseReceiver需要配置在AndroidManifest.xml，请参考“消息配置”章节的相关内容

***示例***

```
/**
* 注册结果
*
* @param context
* APP 上下文对象
* @param errorCode
* 错误码，{@link XGPushBaseReceiver#SUCCESS}表示成功，其它表示失败
* @param registerMessage
* 注册结果返回
*/
```

其中，XGPushRegisterResult提供的方法列表：

|方法名| 返回值|  默认值| 	描述|
|-|-|-|-|
|getToken()	|String|	""|	设备的token，即设备唯一识别ID|
|getAccessId()|	long|	0	|获取注册的accessId|
|getAccount|	String|	""|	获取注册绑定的账号|
|getTicket()|	String|	""|	登陆态票据|
|getTicketType()|	short|	0|	票据类型|
