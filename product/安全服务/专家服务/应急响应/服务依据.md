“工欲善其事，必先利其器”，腾讯云安全专家在多年安全应急服务及安全对抗工作中已经积累了丰富的安全应急响应，其中落地下来包含成熟应急的经验方法论及工具集合，通过经验理论指导操作步骤，通过工具快速定位分析原因，保障入侵工作的快速、及时、有效。
### 一、成熟方法论
#### 1.Windows 应急响应
** 常规分析 **
安全事件发生以后，常常有蛛丝马迹遗留在下列信息当中，处理安全事件时通常会收集这些信息来帮助应急响应支持人员的分析工作。

检查类别	| 检查原因
---|--- 
网络（非法链接）		|是否还存在数据外传、非法外联等行为
进程（服务、端口）	|	是否仍然存在伪造的木马进程
自启动项目		|处理完成后是否还会开机自启
文件		|是否还存在残留的后门或恶意文件
日志		|日志中是否记录了黑客攻击路径和利用方式
驱动	|	底层是否存在有漏洞的驱动版本导致被利用
软件版本		|部分软件版本存在明显安全漏洞或者配置问题

** 恶意代码 **
对于黑客入侵、病毒传播等类型的安全事件来说，支持人员必须要做的一项工作就是要检测事件目标是否已经被植入了恶意代码。
典型的恶意代码可能具有文件感染、数据加密、线程注入、SPI、端口复用、隐秘外联等功能，往往需要依赖于安全专家人为采用第三方检测工具建设深入逆向分析。

####  2. Unix/Linux应急响应
**  常规分析 ** 
同 Windows 类似，主要从网络连接、进程状态、软件版本及配置、文件、启动项、日志等综合分析，收集此类信息后结合安全专家经验进行关联判断分析。
**  恶意代码 **  
由于 Unix 类恶意代码的种类较少，检测目标也以 Rootkit、木马文件为主，其它恶意代码基本在常规检测中通过分析即可得出结果。

####  3.Web 入侵分析
当安全事件发生在 Web 应用上面的时候，安全服务人员会用到 Web 应用检测相关的技术，其中最主要的是 Web 应用访问日志分析及 Web 配置、软件版本分析工作，通过分析可以发现下列类型的安全事件：
- 应用层安全漏洞（SQL 注入、命令执行、信息泄露等）
- 配置缺陷
- 远程扫描等



### 二、高效工具集
本章节列出部分常见的应急响应支持工具，但并不能完整包括真实环境下全部应急响应工具。
#### 1. 信息收集工具

工具名称	|下载地址
---|--- 
Process Explorer	| 微软内置工具集：SysinternalsSuite，进程分析工具
Process Monitor 	|	微软内置工具集：SysinternalsSuite，文件和注册表操作监视工具
LP_Check	|	http://www.dragonsoft.com，隐藏账户检查
Autoruns		|微软内置工具集：SysinternalsSuite，启动项检查工具
Regmon		|微软内置工具集：SysinternalsSuite，注册表监视工具
Tcpview		|微软内置工具集：SysinternalsSuite，网络连接查看工具
Linux 常规工具	|	Linux 自带工具集合，如netstat/ps/ls/nc/iftop
入侵分析脚本	|	腾讯云安全专家内部快速分析自动化脚本

#### 2.恶意代码检测
工具名称	|下载地址
---|--- 
IDA Pro 商业版|	专业逆向工具https://www.hex-rays.com/
OllyDbg	|开源免费工具：http://www.ollydbg.de/
Icesword |	--
Chrootkit	| Linux 常用后门检查工具：http://www.chkrootkit.org
Rootkit hunter |	Linux 常用后门检查工具：http://www.rootkit.nl
#### 3.Web日志分析
工具名称 |	官方地址
---|--- 
LogParser	 |日志分析工具：http://www.microsoft.com
XLogan |	http://www.axeuk.com/xlogan/
AWstats |	http://awstats.sourceforge.net/
日志分析脚本/工具 |	腾讯应急服务专家自用工具集