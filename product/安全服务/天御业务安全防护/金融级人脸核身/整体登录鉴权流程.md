### 1.注意事项
整体鉴权流程基于OAuth2.0认证。合作伙伴同时使用人脸验证/身份证OCR识别服务时，鉴权所需的token、ticket及签名算法可以共用。只需实现各自的业务逻辑即可。
### 2.人脸验证SDK登录鉴权
![](https://mc.qcloudimg.com/static/img/1b08f18e81922acfc57d332398825021/image.png)
**整体登录鉴权流程分为三步：**
**1.第一步：access token获取**
access token 有效期7200秒,建议合作方缓存在服务器,必须在临近过期和使用中失效时重新获取。
**2.第二步：SDK登录鉴权**
1)nonce ticket 有效期120秒,且一次性有效
2)在用户登录流程中，获取api ticket请求的user_id为必填参数，type为NONCE。
**3.第三步：返回结果服务端验证**
SIGN ticket 有效期3600秒,建议合作方缓存在服务器,必须在临近过期和使用中失效时重新获取。流程中，获取api ticket请求的type为SIGN。
3)方式一：签名验证
合作伙伴APP端调用其服务后台验证签名，验证成功后即可信任前端的返回结果。
4)方式二：服务端查询结果
合伙伙伴APP端调用其服务后台查询身份认证结果，由远程身份认证服务端鉴权并返回最终结果。

### 3.人脸验证微信H5登录鉴权
![](https://mc.qcloudimg.com/static/img/008914bde9615e76a3b56e37670ccaa0/image.png)
**整体登录鉴权流程分为三步：**
**1.第一步：access token获取**
access token 有效期7200秒,建议合作方缓存在服务器,必须在临近过期和使用中失效时重新获取。
**2.第二步：合作伙伴后台上送身份信息**
**1)生成签名**
合作伙伴获取SIGN ticket， 有效期3600秒,建议合作方缓存在服务器,必须在临近过期和使用中失效时重新获取。流程中，获取api ticket请求的type为SIGN。根据规则生成签名。
**2)上送身份信息**
合作伙伴上送本次人脸验证的用户身份信息，可以支持合作伙伴提供自带可信比对数据源和使用姓名+身份证获取权威比对数据源两种方式。成功后返回标识信息。
**3.第三步：H5刷脸**
**此处**
1)NONCE ticket 有效期120秒,且一次性有效
2)在用户登录流程中，获取api ticket请求的user_id为必填参数，type为NONCE。
3)方式一：签名验证
合作伙伴APP端调用其服务后台验证签名，验证成功后即可信任前端的返回结果。
4)方式二：服务端查询结果
合伙伙伴APP端调用其服务后台查询身份认证结果，由远程身份认证服务端鉴权并返回最终结果。
具体接入开发指南见：**人脸验证微信H5接入**。

### 4.身份证OCR识别SDK登录鉴权
 ![](https://mc.qcloudimg.com/static/img/38c45a90246d591ad6eddea55d3226c2/image.png)
**整体登录鉴权流程分为三步：
1.第一步：access token获取**
access token 有效期7200秒,建议合作方缓存在服务器,必须在临近过期和使用中失效时重新获取。
**2.第二步：SDK登录鉴权**
5)nonce ticket 有效期120秒,且一次性有效
6)在用户登录流程中，获取api ticket请求的user_id为必填参数，type为NONCE。
**3.第三步：返回结果服务端验证**
SIGN ticket 有效期3600秒,建议合作方缓存在服务器,必须在临近过期和使用中失效时重新获取。流程中，获取api ticket请求的type为SIGN。
7)方式一：签名验证
合作伙伴APP端调用其服务后台验证签名，验证成功后即可信任前端的返回结果。
8)方式二：服务端查询结果
合伙伙伴APP端调用其服务后台查询身份认证结果，由身份证识别服务端鉴权并返回最终结果。
