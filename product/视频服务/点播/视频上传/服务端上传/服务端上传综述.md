<!-- ## 简介

APP 从各个渠道收集到大量精彩的视频，可能会直接将这些视频资源保存在自己的服务器中。这时，APP 会希望对视频进行加工处理（例如转码、截图、打水印等），并将处理后的视频发布到内容分发网络（CDN）中，以供用户观看并为自身创造价值。腾讯云点播支持用户将服务端上的视频文件直接上传到云端，并与点播的视频处理功能（比如转码、截图、防盗链等）无缝结合。

## 上传流程

![图片描述](//mc.qcloudimg.com/static/img/d751bf5e65346dee3a698f097ac2bfdd/image.png)

上图为服务端上传流程示意图，主要有3个参与对象，分别是：APP 服务器、腾讯云点播系统 VOD 和腾讯云存储系统 COS。下面对流程图中的各步骤进行详细说明。

### 第一步：APP 服务器向 VOD 发起上传

APP服务器将文件上传到 COS 前，需要知道目标 COS Bucket、路径等信息。服务端向 VOD 发起上传，获取上传 COS 所需的信息。VOD 校验服务端的请求通过后为其分配上传信息。

服务端请求上传信息时，可以选择只上传视频（只请求视频文件的上传信息），或者同时上传视频和封面（同时请求视频文件和封面文件的上传信息）。

### 第二步：APP 服务器向 COS 上传文件

APP 服务器根据之前发起上传时获取的上传信息，调用 COS 的上传接口完成文件上传。

### 第三步：APP 服务器向 VOD 确认上传

APP 服务器成功上传文件到 COS 后，需要向 VOD 发起确认请求。收到确认上传的请求后，VOD 将返回视频的 fileId、视频播放地址、封面图片地址（如果有）等信息，并按照用户的要求对上传后的视频进行转码、打水印、截图等操作。

## 上传方式

### API

* [APP 服务器向 VOD 发起上传 API](/document/product/266/9756)
* [APP 服务器向 COS 上传文件 API](/document/product/266/9758)
* [APP 服务器向 VOD 确认上传 API](/document/product/266/9757)

### SDK

为了方便用户开发客户端上传功能，云点播提供了基于多语言平台 SDK ：

* [PHP SDK](/document/product/266/9725)
* [Java SDK](/document/product/266/10276)

SDK 基于云图 API 和 COS 的 SDK，封装了服务端和 VOD、COS 交互的细节，上传流程中的第一步到第三步，只需调用 SDK 中的一个接口即可全部完成。因此 ***强烈推荐*** 用户在 APP 中参考点播提供的 SDK 来实现服务端上传。 -->






## 服务端视频上传综述
所谓服务端视频上传，是指APP的**后台运营人员**将本地服务器上视频上传到点播平台。与客户端上传相比，服务端上传一般是由APP内部人员执行的，故而可以直接使用API秘钥(即SecretId和SecretKey)。

服务端上传的大致流程如下图所示。其中，1、2、3步是由APP服务端发起的，4、5、6步是由点播后台发起的。

## 视频上传

视频上传分为[申请上传](/document/product/266/9756)、[上传文件](/document/product/266/9758)、[确认上传](/document/product/266/9757)三步，分别对应上图中的第1、2、3步。

![架构图](//mc.qcloudimg.com/static/img/965ca99592cdd4567a953638e3f14f9f/image.jpg)

为了方便用户开发客户端上传功能，云点播提供了基于多语言平台SDK，每种语言的SDK均包含相应DEMO。

* [PHP SDK](/document/product/266/9725)
* [Java SDK](/document/product/266/10276)

**注意：**
> 由于视频上传本身流程较为复杂，强烈建议开发者使用点播提供的视频上传SDK来进行上传。

### 申请上传

对应服务端上传业务逻辑图中的第1步。

申请上传的主要目的是：
1. 获取视频文件的存储信息；
1. 如果需要将本地图片一并上传作为封面，该接口同时也返回视频封面存储信息；
1. 指定视频上传完成之后的处理方式。

参见：
服务端API：[申请上传](/document/product/266/9756)。

### 上传文件

对应服务端上传业务逻辑图中的第2步。

上传文件，是将本地视频文件上传到点播的存储服务中。点播视频文件的上传接口与腾讯云对象存储服务（COS）相同，您需要使用与COS相同的API或者SDK来进行上传。

参见：
[上传文件](/document/product/266/9758)。

### 确认上传

对应服务端上传业务逻辑图中的第3步。

确认上传的主要目的是：告诉点播系统，文件已经上传完毕，以便点播系统正确地更新媒资信息，并依照申请上传时的参数执行对应的视频处理操作。

该接口调用成功后，调用者将会获取到：
1. 视频FileID；
1. 视频文件URL；
1. 视频封面URL(如果申请上传是时指定了封面)；
1. 视频处理任务ID（如果在申请上传是指定了视频处理方式，即procedure参数）。

参见：
服务端API：[确认上传](/document/product/266/9757)。

## 视频上传事件通知

对应服务端上传业务逻辑图中的第4步。

APP在调用确认上传成功之后，如果APP配置了视频上传完成通知，则点播会依照APP配置的方式发起事件通知。

参见：[事件通知-视频上传完成](/document/product/266/7830)。