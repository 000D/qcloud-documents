## 第二课 初始化SDK&登录

### 导语
欢迎来到`ILiveSDK`系列教程的第二课!

在第一课中，我们已经成功将`ILiveSDK`相关SDK集成到我们的项目中，这次，我们将学习初始化SDK和如何调用登录接口。

### 预备知识
本课程要求用户在[实时音视频官网](https://cloud.tencent.com/product/trtc)完成服务开通及应用创建。

### 相关概念
本课程涉及到的概念有:
> * [实时音视频应用](../开发前必看/基本概念.md#实时音视频应用)
> * [应用标识(sdkAppId)](../开发前必看/基本概念.md#应用标识)
> * [账号类型(accountType)](../开发前必看/基本概念.md#账号类型)
> * [用户标识(identifier)](../开发前必看/基本概念.md#用户标识)
> * [用户签名(userSig)](../开发前必看/基本概念.md#用户签名)

```objc
ERR_EXPIRE              = 8051,    //票据过期(需更新票据userSig)
```

#### userSig的获取

关于userSig的获取参考[用户鉴权](../开发前必看/基本概念.md#用户签名)

在这里我们可以直接开发辅助工具生成userSig
![输入图片说明](https://gitee.com/uploads/images/2018/0328/114805_3c10b1a4_1839574.png "在这里输入图片标题")


### 初始化iLiveSDK

建议在程序启动时就将SDK初始化，初始化需要用到在腾讯云后台创建应用时分配的SDKAppId和AccountType，示例代码如下：

```objc

> AppDelegate.m

// 导入头文件
#import <ILiveSDK/ILiveSDK.h>

// 定义SDKAppId和AccountType
static  const int kSDKAppID = 后台创建应用对应的SDKAppId;
static  const int kAccountType = 后台创建应用对应的AccountType;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    
    // 初始化SDK
    [[ILiveSDK getInstance] initSdk:kSDKAppID accountType:kAccountType];
    
    return YES;
}

```

### 调用登录接口

登录接口位于`ILiveLoginManager`类中，使用时需将其导入，调用方法:

```
- (void)iLiveLogin:(NSString *)uid sig:(NSString *)sig succ:(TCIVoidBlock)succ failed:(TCIErrorBlock)failed;
```
填入后台开发辅助工具生成的identifier和userSig

```objc

> ViewController.m

// 导入头文件
#import <ILiveSDK/ILiveLoginManager.h>

- (void)viewDidLoad {
    [super viewDidLoad];
    
    // 设置identifier和userSig
    self.identifierTF.text = @"用户自己的identifier";
    self.userSigTF.text = @"用户自己生成的userSig";
}

// 登录按钮点击
- (IBAction)onLogin:(id)sender {
    //登录sdk
    [[ILiveLoginManager getInstance] iLiveLogin:self.identifierTF.text sig:self.userSigTF.text succ:^{
        NSLog(@"登录成功！");
    } failed:^(NSString *module, int errId, NSString *errMsg) {
        NSLog(@"errId:%d, errMsg:%@",errId, errMsg);
    }];
}
```

>注：示例程序中用storyboard搭建了一个简单界面，实际应用中客户需根据自己的业务逻辑，将登录代码放置与合适的位置
>
> 且以上仅为示例代码，实际过程中（客户采用独立账号模式），登录流程应为：
>
> **客户端显示登录界面，用户输入账号密码，客户的业务后台验证通过后使用实时音视频后台SDK生成userSig返回给客户端，客户端再拿用户输入的用户名和业务后台返回的userSig调研ILiveSDK的登录接口**
	
运行程序，控制台输出`登录成功！`，即说明ILiveSDK登录成功。

### [源码下载](http://dldir1.qq.com/hudongzhibo/ILiveSDK/Demo/iOS/demo_login.zip)

[上一课 集成SDK](集成SDK.md)

[下一课 创建房间](创建房间.md)

