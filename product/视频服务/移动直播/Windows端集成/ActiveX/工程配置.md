# 工程配置

## AtiveX插件——SDK信息

您可以从腾讯云官网 [直播SDK](https://cloud.tencent.com/document/product/454/7873)中获取目前最新ActiveX插件SDK有。

下载完的SDK解压后有以下几个部分：

![](https://mc.qcloudimg.com/static/img/d4f7e0e05b250d5ade298c14f3876522/image.png)


| 文件名  | 详情                                       |
| ---- | ---------------------------------------- |
| demo | demo包含调用sdk/LiteAVAX.cab的html和js源码，可以直接参考如何使用activex插件开发音视频，目前支持推拉流和双人视频的demo。 |
| sdk  | ActiveX插件是LiteAVAX.cab，带在html和js资源包里面，version指明当前插件版本号。 |
| doc  | 包含接入文档、接口等。                              |



## AtiveX插件开发配置

### 支持平台

- SDK支持Windows 7或更高版本
- 支持ie9、ie10、ie11

### 开发环境

所有PC客户端下的html+javascript IDE

### AtiveX插件原理

 实际音视频应用中，无论多复杂的音视频功能，我们都可以将其拆分解卫两个基本模块的组合，一个是音视频推流，一个是音视频拉流：

- 音视频推流：包括采集、编码、传输，即音视频上行。
- 音视频拉流：包括抖动缓存、解码和播放，即音视频下行。
  ActiveX插件主要将音视频封装成推流模块（pusher对象）和拉流模块（player对象）供js调用。![pusher-and-player](res\pusher-and-player.png)

### AtiveX插件SDK接入页面工程

ActiveX导出pusher对象和player对象可以通过< object/>标签使用，样例代码

```javascript
//demo_plusher.html
<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312"/>
<TITLE>对象 LiteAVAxPlugin 的 ATL 测试页</TITLE>
<script type="text/javascript" src="pusher_player.js" charset="utf-8"></script>
</HEAD>
<BODY>
  PUSH_URL:
  <input size="90" id="targetTextField" value="">
  <input type=submit value="StartPush" onClick="doStartPush(document.getElementById('targetTextField').value);">
  <br/>
  <object ID="pusher" CLASSID="CLSID:01502AEB-675D-4744-8C84-9363788ED6D6"
                        codebase="./LiteAVAX.cab#version=1,2,0,0"
                        width="320"
                        height="240">
  </object>
  <script>
	  function doStartPush(targetURL) {
			pusher.startPush(targetURL);
	  }
  </script>
</BODY>
</HTML>
```

#### step1：创建ActiveX插件SDK示例环境

创建demo_plusher.html文件，将LiteAVAX.cab拷贝到同级目录

#### step2：创建pusher的< object/>标签

1.pusher对象的CLASSID必须为"CLSID:01502AEB-675D-4744-8C84-9363788ED6D6"。

```javascript
 <object ID="pusher" CLASSID="CLSID:01502AEB-675D-4744-8C84-9363788ED6D6"
                        codebase="./LiteAVAX.cab#version=1,2,0,0"
                        width="320"
                        height="240">
  </object>
```

2.引用ActiveX插件SDK，codebase="./LiteAVAX.cab#version=1,2,0,0"，通过相对路径引用，同时指定版本号。

3.< object ID="pusher"...>即创建了pusher对象，可以用js调用pusher对象的接口（具体接口参考pusher接口文档），示例如下：

```javascript
	  function doStartPush(targetURL) {
			pusher.startPush(targetURL);
	  }
```

3.player对象创建和上面例子一样，但是CLASSID必须为"CLSID:99DD15EF-B353-4E47-9BE7-7DB4BC13613C"。

#### step3：执行demo，

IE上运行demo_plusher.html页面，检测是否插好摄像头设备，输入推流URL，点击StartPush按钮即可

（URL 以 “rtmp://” 打头 ，腾讯云推流 URL 的获取方法见 [DOC]( https://cloud.tencent.com/document/product/454/7915 "腾讯云-推拉流地址Doc") ）

运行效果图如下： ![demo_effect](res\demo_effect.png)

