
## 美女直播

### Step1: 更新 1.9.1 版SDK 
这一版本的 RTMP SDK 中，我们对美颜做了很大的提升，主要体现在：

- **细节提升**：新版本美颜通过全新的区域识别和面部检测方案，将眼睛、眉毛、胡须、头发等细节的处理尽可能削减为零，以保证最大限度的接近真实情况。

- **前景侧重**：通过对编码方案进行优化，突出对前景人物的侧重，尽可能保留主播的细节，忽略其它非重要部分，在同样的码率下可以呈现更加清晰亮丽的人物细节。

- **算法优化**：通过对磨皮算法的优化，在真实度上提升的同时降低了GPU的负载，解决了之前把美颜效果调高后画面细节损失严重，“宛如油画”的效果不再出现，同时耗电和发热问题也有所改善。

- **曝光改善**：通过启用新的曝光方案，解决了iOS曝光过度的问题；同时针对 Android 各机型摄像头曝光敏感度不同的现状，提供了曝光设置功能，可以让主播在曝光不理想（低端机较常见）时手动修正曝光效果。

- **滤镜效果**：新版本美颜还增加了色彩滤镜效果，八种自带的滤镜给主播一些个性化的风格选择，滤镜的设计和调配均出自我们专业的视觉团队，无需担心版权问题。
  
### Step2: 设置画质级别
我们要知道直播端看到的画面跟观众端看到的画面是不一样的：

- **主播端**： 
   主播端看到的画面是只经过了 “采集” 和 “预处理" 两个过程，也就是画面从摄像头采集到之后，经过美颜和各种前处理就渲染在了手机屏幕上。
	 
- **观众端**： 
   主播端看到的画面先要经过**视频编码**，然后通过网络传输到观众端，并在观众端完成**视频解码**和渲染才能观看，这样做是为了降低视频在网络上的传输数据量，但视频编码+视频解码会导致画质的损失，而且不合理的参数设置会导致画质损失非常严重。
	 
- **怎么办？**
我在 1.9.1 版本的 TXLivePusher 中加入了 setVideoQuality 函数，并给出了几个级别的设置，您选择 **高清** 模式即可达到最佳的美女直播效果。详情请关注 [iOS平台](https://www.qcloud.com/document/product/454/7879#step-9.3A-.E6.8E.A8.E8.8D.90.E7.9A.84.E6.B8.85.E6.99.B0.E5.BA.A6) & [Android平台](https://www.qcloud.com/document/product/454/7885#step-9.3A-.E6.8E.A8.E8.8D.90.E7.9A.84.E6.B8.85.E6.99.B0.E5.BA.A6)。

### Step3: Android 增加手动曝光
同样美颜算法，在不同的 Android 手机上差异可能很大，究其原因，主要是曝光的差异产生了视觉感受的大不同。

在 iOS 平台我们采用了系统的自动曝光，但是 Android 机型差异太大，很多千元机的自动曝光效果实在一般，所以我们还是推荐在您的 UI 界面上提供一个自动曝光的操作滑竿，让主播可以自己调节曝光值大小，以符合他/她的预期。

Android 版 RTMP SDK 中的 TXLivePush::**setExposureCompensation** 接口提供了调节曝光的能力，参数 value 为 -1 到 1 的浮点数： 0 表示不调整， -1 是将曝光降到最低， 1 表示是将曝光加强到最高。

![](//mc.qcloudimg.com/static/img/b4c3fcc20a580347bb1360c5b59fd08c/image.png)




