# 分布式配置

### 本地仓库JAR包安装

目前Spring Cloud for TSF的第三方包暂没有发布到公有maven仓库，需要将相关TSF JAR包安装到本地仓库。

`mvn install:install-file -Dfile=jar包存放目录 -DgroupId=org.springframework.cloud -DartifactId=spring-cloud-consul-config -Dversion=1.2.0.TSF-RELEASE -Dpackaging=jar`

> 注： 如本地 Maven 仓库中已经有了对应版本的 spring-cloud-consul-config 的依赖包，可忽略该步骤。

### 依赖项

添加pom.xml依赖

```xml
<dependency>
	<groupId>org.springframework.cloud</groupId>
	<artifactId>spring-cloud-consul-config</artifactId>
	<version>1.2.0.TSF-RELEASE</version>
</dependency>
```

### 修改配置文件

修改配置文件，添加配置项

```spring.profiles.active: ${tsf_application_id}/${tsf_group_id}```


### 修改 Info 类

在 `tsf-springcloud-demo` 的 `Info`类中，使用 `@ConfigurationProperties` 注解来标明这个类是一个配置类。

```
@Component
@RefreshScope
@ConfigurationProperties(prefix="info")
public class Info {
	private String consumerName = "defaultConsumerName";
	private String providerName = "defaultProviderName";
	private int interval = 5000;

	public String getConsumerName() {
		return consumerName;
	}

	public void setConsumerName(String consumerName) {
		this.consumerName = consumerName;
	}

	public String getProviderName() {
		return providerName;
	}

	public void setProviderName(String providerName) {
		this.providerName = providerName;
	}

	public int getInterval() {
		return interval;
	}

	public void setInterval(int interval) {
		this.interval = interval;
	}
}
```

### 动态更新配置

关于如何通过控制台创建及下发更新的配置，参考 [应用配置](https://cloud.tencent.com/document/product/649/15539)。

比如希望修改 Info 中的 `providerName` 的值，创建配置时，配置内容填写: 

```
info.providerName=newProviderName
```

将配置发布到对应的部署组上，检查打印的日志中是否出现：

```
provider name is newProviderName
```



