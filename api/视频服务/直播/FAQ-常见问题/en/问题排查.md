
## 1. Viewers cannot watch my broadcast
  Please do the following to check:
  ![problem](//mccdn.qcloud.com/static/img/0b37831c5d7bca20d5e465b6d8953937/image.jpg)

- **0. Check the address**:
  > Check whether you're <font color='red'>using the push address mistakenly as the play address.</font>.
  > ![diff](//mccdn.qcloud.com/static/img/1d093770d4b9bfaec5e15b01bdb65d00/image.png)

- **1. Check the player**:
  >Check whether the player is running properly. Try VLC player (downloaded and installed on the PC) and Flash player. [Recommended Test Address](http://www.cutv.com/demo/live_test.swf)).
  >
  >If the video is played properly on VLC player or Flash player, but not on Tencent Cloud [STA Demo](https://www.qcloud.com/doc/product/267/4821), the problem may be caused by compatibility of the player. Please feedback to us if this happens.
  >
  >If the video cannot be played on VLC player or Flash player, please continue checking.
  >

- **2. Check the downstream network**:
  >The corporate network of many customers limits the video play. The limiting principle is that the firewall detects whether HTTP requests are streaming resources.
  >
  >If you can watch the LVB normally via the 4G network but cannot watch it in the Wi-Fi network of your company, the video play is limited in accordance with the network strategy of the company. Please contact your network administrator to change the policy.
  >
  >
- **3. Check the channel settings**:
   >1. Make sure the channel status is NOT "Disabled". Disabled channels cannot be pushed or watched.
  >![disable](//mccdn.qcloud.com/static/img/d2273e61409a5d2c89e7f1e0018963ca/image.jpg)
  >
  >2. Make sure you've enabled the correct protocols for the channel. For example, you want to play FLV videos on the App, but only HLS is enabled in channel settings.
  >![edit](//mccdn.qcloud.com/static/img/2687d18bd59b639cdbbbc535cc85eed7/image.jpg)
  >In this case, click **Edit** in the upper-right corner, and check FLV protocol to enable it.
  >![flv](//mccdn.qcloud.com/static/img/1fa26a7758383bc1dbf58dffb6370576/image.jpg)

- **4. Check the upstream network of the VJ**:
  >Insufficient upstream network bandwidth is a common problem. Carriers in China pose very stringent control over the upstream bandwidth of Chinese netizens. If the VJ requires more clear view, higher upstream bandwidth is required.
  >
  >Start the [STA Demo](https://www.qcloud.com/doc/product/267/4821), scan your push address to test the push. Start the log panel and observe **SPD** (upstream speed) and **VBR** (video bit rate, that is, number of data bits generated by the video coder per second).
  >![compare](//mccdn.qcloud.com/static/img/07e38ceed7cfe097f34734acc50c56f5/image.jpg)
  >
  >The information in the preceding figure on the right shows that the video is not played normally on the STA. It is recommended to switch to a normal network for testing.


- **5. Check the push end**:
  >Currently, the most popular push software is [OBS](https://obsproject.com/). You can use the OBS to push streams to check whether an exceptions occurs. Few cases show that the push end is faulty because all protocols, with which the push SDK complies, conform to standard definitions. By contrast, the following issue is very common:
  >
  >**The push address is occupied**
  >If an address is pushed by a push end, the push will fail if another push end also uses this address for pushing.
  >![conflict](//mccdn.qcloud.com/static/img/e8c4de29cb91419ba50146c0cacfd824/image.jpg)
  >
  >**A hotlink protection signature problem occurs**
  >If your push URL contains txSecret and txTime, your URL is under hotlink protection. For details, see "Security Protection" (https://www.qcloud.com/doc/api/258/5693). If your URL is unavailable, check whether txTime in the URL has expired and check whether txSecret is computed incorrectly.


## 2. Causes of Video stuttering
### 2.1 RTMP Push Quality

The RTMP push quality is very crucial to watch experience. If the push quality of the VJ is poor, the video view watched by all watchers is stuck. The statistics show that more than 80% of LVB video freezing issues experienced by customer groups are caused by poor RTMP push quality. 

The RTMP SDK provides a status feedback mechanism, in which the RTMP SDK reports various status parameters every 1-2 seconds. You can register the **TXLivePushListener** listener to obtain these status parameters.

![](//mc.qcloudimg.com/static/img/48fd46af4e17b0299fd00a0e661a16f0/image.png)

|  Push status                   |  Description                    |   
| :------------------------  |  :------------------------ | 
| NET_STATUS_CPU_USAGE | CPU utilization for the current process and overall CPU utilization for the machine |
| NET_STATUS_VIDEO_WIDTH | Width of the current video (in pixels) |
| NET_STATUS_VIDEO_HEIGHT | Height of the current video (in pixels) |
| NET_STATUS_NET_SPEED | Current transmission speed in kbps |
| NET_STATUS_VIDEO_BITRATE | Output bit rate of the current video encoder (kbps)|
| NET_STATUS_AUDIO_BITRATE | Output bit rate of the current audio encoder (unit: kbps)|
| NET_STATUS_VIDEO_FPS | Current video frame rate (frames per second)|
| NET_STATUS_CACHE_SIZE | Audio/video data accumulated. If this value exceeds 10, it means that the current uplink bandwidth is not enough to consume audio/video data produced |
| NET_STATUS_CODEC_DROP_CNT | The number of global packet losses. In order to avoid the continued severe accumulation of packets, the SDK begins to actively discard packets after the warning line is reached. The more packets are lost, the severer network problems are. |
| NET_STATUS_SERVER_IP | IP of the push server |
| NET_STATUS_NET_JITTER | Network jitter |

### 2.2 Judgment of Push Quality
The following are several judgment criteria that we often use.

**1. BITRATE and NET_SPEED**
> BITRATE(= VIDEO_BITRATE + AUDIO_BITRATE) refers to how much audio/video data the encoder produces per second. NET_SPEED refers to how much audio/video data the encoder actually pushes per second. Therefore, if BITRATE equals to NET_SPEED consequently, the push quality will be good.
>
>And if the BITRATE >= NET_SPEED, then push quality is poor.

**2. CACHE_SIZE and DROP_CNT**
> If BITRATE> = NET_SPEED, the audio/video data generated by the encoder will be accumulated in the VJ's phone. The severity is indicated by the value of CACHE_SIZE. When the CACHE_SIZE value reaches a threshold, SDK will automatically discard some audio/video data, which will increase DROP_CNT.
>
> If CACHE_SIZE value stays over 10, or DROP_CNT value increases, it indicates that the VJ's network condition is poor and the push quality may be affected.
>
>See below for an example of <font color='blue'> video lagging caused by insufficient uplink bandwidth</font>:
>![](//mc.qcloudimg.com/static/img/319d6197da603ca15ffc6e2afd778e48/image.png)

**3. CPU_USAGE** 
> RTMP SDK keeps the CPU usage for push below 50%, especially when hardware coding is enabled. For example, on Xiaomi 3, when hardware acceleration is enabled, 720p definition push requires no more than 30% of CPU utilization.
>
>However, for an LVB App, there must be other CPU usage, e.g. floating comments, text messaging and drop-down effects.
>
>If the overall CPU utilization exceeds 80%, video capture and coding may be affected. If the CPU utilization reaches 100%, the VJ end is already in a mess, not to mention the viewer end.

**4. Ping value of SERVER_IP**
> If the Ping value between the VJ IP and SERVER_IP is high (e.g. over 500ms), the push quality will be poor. In this case, please feedback to us.

### 2.3 SDK Push Quality

The charts shown in 2.2 are from our internal data analysis system for experimental testing. If you have the same analysis demands, you can find similar charts on the quality monitoring system of [LVB console](https://console.qcloud.com/live). Those charts are simpler and their understanding does not require too much professional audio/video fundamentals.
![](//mc.qcloudimg.com/static/img/4bf231da79ec8e45bdc4c16c927da47f/image.png)

## 3. I encountered long latency
Normally, the latency of RTMP push + FLV play is about **<font color='red'>2-3 seconds</font>**. If you encounter latencies longer than this, please check the following:
- **Step 1. Check the play protocol**.
  >If you use HLS protocol, the latency will be longer. HLS is based on the streaming protocol using large-granularity TS fragments. Each fragment has a duration of more than 5 seconds and there are 3-4 fragments in total. Therefore, the total delay is about 20-30 seconds. You can change to FLV protocol to fix this problem.

- **Step 2. Check the player settings**.
   >Tencent Cloud RTMP SDK player provides 3 modes, **<font color='red'>Speed</font>**, **Smooth** and **Auto**.
   > + Speed mode: The latency is within 2-3 seconds in most scenarios.
   > + Smooth mode: The latency is longer than 5 seconds in most scenarios.
   > + Auto mode: For good network connections, the latency is within 2-3 seconds. Otherwise, the latency is adjusted to be longer than 5 seconds.
   >
   >![](//mc.qcloudimg.com/static/img/9e958f11e25eb2d2ca21c5935ae094e1/image.png)

- **Step 3. Disable backend watermark**
  >Tencent Cloud supports backend watermarking, with the aim of meeting the requirements of customers who cannot use Tencent Cloud RTMP SDK streamer (supporting watermarking at the LVB end) but still need watermarking. Watermarking will increase the delay by 3 seconds. Therefore, if you use Tencent Cloud RTMP SDK to push streams, disable the backend watermarking function and add watermarks on the APP at the VJ end.

- **Step 4. Check whether the video is played immediately after streams are pushed**.
  >The streaming processing of Tencent Cloud backend needs some time for buffering and preheat. If you play the video immediately after pushing streams, the test data is inaccurate. You are recommended to test the real delay 15-30s after streams are pushed.

- **Step 5. Check whether a third-party streamer is used**.
  > We ensure the ideal effect only when the Tencent Cloud integrated solution is used. If you use third-party streaming software, it is recommended to use the push demo of Tencent Cloud RTMP SDK for a comparison, to exclude the possibility that long delay is caused by code buffering of the third-party streamer.

## 4. Extended and Distorted Views
![](//mccdn.qcloud.com/static/img/64012a07f85259bb3246c40e1014dcb4/image.png)

- **Possible causes**
> Check whether the play address ends with <font color='red'>550 or 900</font>. The address is the play address transcoded at the backend (the original bit rate is converted into standard-definition or high-definition bit rate). The fixed aspect ratio of 16:9 is used at the backend for transcoding. As a result, views with the aspect ratio of 9:16 are converted into views with the aspect ratio of 16:9, causing extension or distortion of views. [](//mccdn.qcloud.com/static/img/3d507395719b716d6efd379f7022d862/image.png)

- **Transcoding**
>Transcoding is often used for game LVB, whose original bit-rate is over 1.5 Mbps and the original definition is mainly 1080p and 720p. High bit-rate provides excellent experience on large-screen PCs, but it's not necessary for small-screen mobile phones. Therefore, the high-definition (900 kbps) and low-definition (550 kbps) real-time transcoding service is required.
>
>If your original video is not with high quality (e.g. bit-rate is lower than 1 Mbps), transcoding is unnecessary.

## 5. Artifacts and Green Screen

### 5.1 Causes for Artifacts and Green Screen
![screen_broken_vs_green](http://qzonestyle.gtimg.cn/qzone/vas/opensns/res/img/screen_broken_vs_green.jpg)

- **Normal artifacts**
A large area of pixelation occurs when the bit rate is especially low. The artifact is normal in this case and this case is commonly known as fuzzy screen. For example, if the video coder (such as x264) needs to output the view with the 1280*720 high-definition resolution and needs to use only 200 kbps bit rate (bit rate refers to the number of video data bits generated by the coder per second), the coder has to reduce the view quality unlimitedly, for example, a large area of pixelation.

- **Regional artifacts**
In the preceding figure on the left, the artifact is abnormal, and regional disorder is displayed on the screen. The major causes are as follows:
  + The P frame is lost: If one P frame is lost, the view after the frame is displayed erratically. The simplest diagnosis is to check the poc.
  + The P frame is damaged: If the P frame is not lost but damaged, regional artifact also occurs.
  + The I frame is damaged: The I frame can be simply understood as one JPG picture. If the picture is not decoded correctly, regional artifact occurs and the display lasts for a period of time because the subsequent P frame cannot correct the damaged I frame.
  + The B frame is in disorder: After the B frame is introduced to H.264, artifact occurs when the sequence between frames is in disorder.
  
- **Regional green screen**
The preceding figure on the right shows regional green screen. The causes for regional green screen are similar to those for abnormal artifact. On many systems, views that cannot be rendered are filled with black color, green color, or the previous-frame view. Therefore, the same video are represented differently on different play devices.

- **Full-screen green screen**
 + The I frame is damaged thoroughly: The player cannot recover the I frame that is damaged thoroughly but has to fill it with green color (black color, or completely disordered image). In this case, the false view lasts for several seconds.
 + The first frame is not the I frame: The first frame output by some unprofessional CDNs is not the I frame when video streams are output. The consequence is the same as the damage of the I frame. In this case, the false view lasts for several seconds.
 + An Sps&pps error occurs: The sps&pps information error may mislead the decoder. In this case, the view error is unrecoverable and the green screen (black screen, or completely disordered view) lasts all the time.


### 5.2 Solutions to Artifacts and Green Screen
After about two years of technical accumulation and precipitation, Tencent video cloud is stable and reliable in the streaming channel robustness. Lost frames and damaged frames introduced during transmission basically do not occur. The clear troubleshooting ideas are as follows:
- **Step 1: Check the player.**
For example, use the SDK Demo of Tencent video cloud to check whether the same fault occurs. Use multiple players to check whether the fault is caused by player compatibility.

- **Step 2: Check the video source.**
Check whether the video source is stable. For example, some unprofessional push software discards some data frames randomly when data accumulates. As a result, the P frame or I frame is lost and artifact occurs. If artifact still occurs on players featuring good compatibility such as the VLC player, there is a high probability that the video source is unstable.

- **Step 3: Check whether operations conform to standards.**
If the resolution needs to be switched during push, it is recommended to re-push streams. Though Tencent video cloud supports resolution switching in hot mode, switching will cause many hidden risks for stored videos, for example, videos in the MP4 format do not support multiple resolutions. If the resolution is switched during recording of an MP4 file, artifact is unavoidable.

## 6. Black Screen and Black Border
- **Permission restrictions**:
If the permission of starting a camera is not granted, the PUSH_ERR_OPEN_CAMERA_FAIL event is received. Check the camera permission. If this event is not received, contact us and provide your model and system. In addition, for Android 6.0, you need to check and grant the camera permission. Otherwise, black screen occurs.

- **Resolution out of range**:
The video resolution exceeds the maximum resolution supported by the SDK. The SDK supports the maximum 1920*1080 resolution. Check the video resolution.

- **Display mode**:
"setRenderMode" may be set to "RENDER_MODE_ADJUST_RESOLUTION" but the view does not conform to the current aspect ratio of the screen, for example, the 16:9 view is displayed on the 4:3 screen.

