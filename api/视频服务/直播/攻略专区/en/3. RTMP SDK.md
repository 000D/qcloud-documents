
The RTMP SDK is an integral part in the mobile terminal video solution of Tencent Cloud. It supports the three functions of RTMP push, online LVB and VOD playback. The using modes of these three functions all comply with one principle: **it can be driven by one URL (push URL, LVB URL or VOD URL)**.

![](//mc.qcloudimg.com/static/img/348ceadfd4213e4b360a8979b2cf540a/image.png)

## Interworking Process
1. First generate one pair of push and play addresses at "LVB Console"(https://www.qcloud.com/doc/api/258/6445), which are used to test push and LVB watching.
2. Interwork with the RTMP pushing function. The process requires 0.5 d to 1 d usually.
3. Interwork with the online LVB function. The process requires 0.5 d to 1 d usually.
4. Interwork with the VOD function (depending on the requirement): First "Activate VOD Service" (https://www.qcloud.com/doc/api/258/6208#2.1-.E5.A6.82.E4.BD.95.E5.BC.80.E9.80.9A.E8.A7.86.E9.A2.91.E7.82.B9.E6.92.AD.E6.9C.8D.E5.8A.A1), and then splice &record=flv ( or mp4) after the push URL to record the video of push. After that, the related video can be seen at "VOD Console" (http://console.qcloud.com/video/videolist).
5. Next, change the test URL to the formal push/pull address after interworking of "LVB Backend" (https://www.qcloud.com/doc/api/258/6447) is completed.

## RTMP push
RTMP push means that the SDK completes audio and video collection and coding, and then the standard RTMP is used to push the audio and video streams to the specified push URL.

- **Camera LVB ("iOS Platform"(https://www.qcloud.com/doc/api/258/6455) &  "Android Platform"(https://www.qcloud.com/doc/api/258/6456))**
Camera LVB means that the SDK collects the camera effect and microphone sound, and then completes the coding and push work. The iOS 7, Android 4.2 and OSs of higher versions are supported.

- **Mobile phone screen recording LVB ("iOS Platform"(https://www.qcloud.com/doc/api/258/6460) & " Android Platform"(https://www.qcloud.com/doc/api/258/6457)**
Mobile phone screen recording LVB means that the SDK collects the mobile phone screen picture and microphone sound, and then completes the coding and push work. The iOS 10, Android 5.0 and OSs of higher versions are supported.

- **Advanced Application ("Reference Document"(https://www.qcloud.com/doc/api/258/6458))**
  + For the customer who wants to know the internal principle of RTMP SDK
  + The customer who has acquired the related development experience of audio and video and needs to customize parameters in line with its scenario
  + The customer who only uses the RTMP SDK to push stream

## Online LVB (LIVE)
A video source being pushed in real time is watched during online LVB. In comparison with the VOD for which the video is pre-loaded to the local place several minutes in advance and then played step by step, online LVB needs to fix several more difficult problems:

- **Low Delay**
Online LVB needs to ensure that the delay from the VJ to the audience cannot be too high, for example, the minimum delay of the RTMP and FLV protocols must be controlled within 2-3 seconds. This means that the thought of "large buffer & secure broadcast" is not suitable anymore.

- **Less Freezing**
Since the delay cannot be too large, video buffer cannot be too frequent. As a result, the problem of video freezing cannot be offset by a large section of buffer.  Furthermore, continuous piling of delay must also be fixed immediately after video freezing.

- **Play in Seconds**
The video can be watched immediately when a studio is opened. This is the basic requirement for a qualified LVB App. Therefore, the player is too poor if it does not support play in seconds.

Now, the performance of the RTMP SDK of Tencent Cloud in the above three aspects has been recognized by all the customers, and the interworking cost is also very low. Usually, the work can be completed in 1 d.

- "iOS platform reference"(https://www.qcloud.com/doc/api/258/4736) 
- "Android platform reference"(https://www.qcloud.com/doc/api/258/4737) 

## Video on Demand (VOD)
The internal principle and optimization solution of VOD are largely different from those of online LVB, but their interfaces are basically consistent. Pay attention to the following two differences in use:
- VOD supports the pause and resume operations, but LVB does not support them.
- The event notifications of VOD include the PLAY_EVT_PLAY_PROGRESS progress notification, but it is not supported by LVB.
- For VOD and LVB, the video type cannot be wrongly selected when startPlay is invoked. <font color='red'>Fast motions will be presented if the LVB player is used to play VOD video</font>.

The VOD player of RTMP SDK is oriented to the recording playback requirement of LVB customers, so we will not pursue completeness in format support. We only provide support to three VOD formats: FLV (supporting resolution switching and horizontal and vertical screen switching), HLS, and MP4. 

If the LVB video has been received, the VOD function can be implemented anytime:
- "iOS Platform Reference Document"(https://www.qcloud.com/doc/api/258/4738) 
- "Android Platform Reference Document"(https://www.qcloud.com/doc/api/258/4739) 

## Small LVB
Set out below is the code position of the RTMP SDK interworking part in the Small LVB source code:

### Android Platform
-**Push underlying layer**:
  + TCPusherMgr.java:  LVB management class, communicating with the backend, pulling the LVB address, and notifying the backend to exit LVB
-**Push interface**:
  + TCLivePublisherActivity.java:  Push module activity; all the push management, message management and special effects of animation are implemented in this class.
-**Playback underlying layer:**
  +  TCPlayerMgr.java:  Play management class, communicating with the backend and informing the backend of room entry, room exit, and liking events
-**Playback interface:**
  + TCLivePlayerActivity.java:  Play module activity, including VOD and LVB; all the play management, message management and special effects of animation are implemented in this class.

### iOS Platform
-**Push underlying layer**:
  + TCPusherMgr:  The logic layer code of push module, implementing protocol communication with the service server
-**Push interface**:
  + TCPushController: the main controller of push module, which bears the rendering view, logic view and push related logic inside; meanwhile, it also receives the event notification of SDK layer.
  + TCPushDecorateView: the push module logic view, which presents the message list, bullet screen animation, audience list, beauty, whiting and other UIs inside, wherein the logic interaction with the SDK needs to be processed by the main controller.
-**Playback underlying layer:**
  + TCPlayerMgr:  The logic layer code of play module, implementing protocol communication with the service server
-**Playback interface:**
  + TCPlayController: the main controller of play module, which bears the rendering view, logic view and play related logic inside; meanwhile, it also receives the event notification of SDK layer.
  + TCPlayDecorateView: the play module logic view, which presents the message list, bullet screen animation, audience list, and other UIs inside, wherein the logic interaction with the SDK needs to be processed by the main controller.


